<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianrui.service.mapper.businessManage.salesManage.SalesArriveMapper" >
  <resultMap id="BaseResultMap" type="com.tianrui.service.bean.businessManage.salesManage.SalesArrive" >
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="auditstatus" property="auditstatus" jdbcType="VARCHAR" />
    <result column="source" property="source" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="vehicleid" property="vehicleid" jdbcType="VARCHAR" />
    <result column="vehicleno" property="vehicleno" jdbcType="VARCHAR" />
    <result column="vehiclerfid" property="vehiclerfid" jdbcType="VARCHAR" />
    <result column="driverid" property="driverid" jdbcType="VARCHAR" />
    <result column="drivername" property="drivername" jdbcType="VARCHAR" />
    <result column="driveridentityno" property="driveridentityno" jdbcType="VARCHAR" />
    <result column="billid" property="billid" jdbcType="VARCHAR" />
    <result column="billcode" property="billcode" jdbcType="VARCHAR" />
    <result column="billdetailid" property="billdetailid" jdbcType="VARCHAR" />
    <result column="abnormalperson" property="abnormalperson" jdbcType="VARCHAR" />
    <result column="abnormalpersonname" property="abnormalpersonname" jdbcType="VARCHAR" />
    <result column="abnormaltime" property="abnormaltime" jdbcType="BIGINT" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="takeamount" property="takeamount" jdbcType="DOUBLE" />
    <result column="actualtakeamount" property="actualtakeamount" jdbcType="DOUBLE" />
    <result column="spraycode" property="spraycode" jdbcType="VARCHAR" />
    <result column="serialnumber" property="serialnumber" jdbcType="VARCHAR" />
    <result column="icardid" property="icardid" jdbcType="VARCHAR" />
    <result column="icardno" property="icardno" jdbcType="VARCHAR" />
    <result column="state" property="state" jdbcType="VARCHAR" />
    <result column="maindeduction" property="maindeduction" jdbcType="VARCHAR" />
    <result column="makerid" property="makerid" jdbcType="VARCHAR" />
    <result column="makebillname" property="makebillname" jdbcType="VARCHAR" />
    <result column="makebilltime" property="makebilltime" jdbcType="BIGINT" />
    <result column="remarks" property="remarks" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="createtime" property="createtime" jdbcType="BIGINT" />
    <result column="modifier" property="modifier" jdbcType="VARCHAR" />
    <result column="modifytime" property="modifytime" jdbcType="BIGINT" />
    <result column="startloadingtime" property="startloadingtime" jdbcType="BIGINT" />
    <result column="endloadingtime" property="endloadingtime" jdbcType="BIGINT" />
    <result column="sealtime" property="sealtime" jdbcType="BIGINT" />
    <result column="forceOutFactory" property="forceOutFactory" jdbcType="BIT" />
    <result column="forceOutFactoryPerson" property="forceOutFactoryPerson" jdbcType="VARCHAR" />
    <result column="forceOutFactoryTime" property="forceOutFactoryTime" jdbcType="BIGINT" />
    <result column="validStatus" property="validStatus" jdbcType="VARCHAR" />
    <result column="sendPerson" property="sendPerson" jdbcType="VARCHAR" />
    <result column="sendPersonName" property="sendPersonName" jdbcType="VARCHAR" />
    <result column="sendTime" property="sendTime" jdbcType="BIGINT" />
    <result column="sendID" property="sendID" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, code, auditstatus, source, status, vehicleid, vehicleno, vehiclerfid, driverid, drivername, 
    driveridentityno, billid, billcode, billdetailid, abnormalperson, abnormalpersonname, abnormaltime, 
    unit, takeamount, actualtakeamount, spraycode, serialnumber, icardid, icardno, state, maindeduction, 
    makerid, makebillname, makebilltime, remarks, creator, createtime, modifier, modifytime, startloadingtime,
    endloadingtime, sealtime, forceOutFactory, forceOutFactoryPerson, forceOutFactoryTime, validStatus,
    sendPerson, sendPersonName, sendTime, sendID
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_sales_db_arrive
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete from tr_sales_db_arrive
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesArrive" >
    insert into tr_sales_db_arrive (id, code, auditstatus, 
      source, status, vehicleid, 
      vehicleno, vehiclerfid, driverid, drivername, 
      driveridentityno, billid, billcode, billdetailid,
      abnormalperson, abnormalpersonname, abnormaltime, 
      unit, takeamount, actualtakeamount, spraycode, 
      serialnumber, icardid, icardno, 
      state, maindeduction, makerid, makebillname, 
      makebilltime, remarks, creator, 
      createtime, modifier, modifytime,
      startloadingtime, endloadingtime, sealtime,
      forceOutFactory, forceOutFactoryPerson, forceOutFactoryTime, validStatus,
      sendPerson, sendPersonName, sendTime, sendID
      )
    values (#{id,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, #{auditstatus,jdbcType=VARCHAR}, 
      #{source,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, #{vehicleid,jdbcType=VARCHAR}, 
      #{vehicleno,jdbcType=VARCHAR}, #{vehiclerfid,jdbcType=VARCHAR}, #{driverid,jdbcType=VARCHAR}, #{drivername,jdbcType=VARCHAR}, 
      #{driveridentityno,jdbcType=VARCHAR}, #{billid,jdbcType=VARCHAR}, #{billcode,jdbcType=VARCHAR},  #{billdetailid,jdbcType=VARCHAR}, 
      #{abnormalperson,jdbcType=VARCHAR}, #{abnormalpersonname,jdbcType=VARCHAR}, #{abnormaltime,jdbcType=BIGINT}, 
      #{unit,jdbcType=VARCHAR}, #{takeamount,jdbcType=DOUBLE}, #{actualtakeamount,jdbcType=DOUBLE}, #{spraycode,jdbcType=VARCHAR}, 
      #{serialnumber,jdbcType=VARCHAR}, #{icardid,jdbcType=VARCHAR}, #{icardno,jdbcType=VARCHAR}, 
      #{state,jdbcType=VARCHAR}, #{maindeduction,jdbcType=VARCHAR}, #{makerid,jdbcType=VARCHAR}, #{makebillname,jdbcType=VARCHAR}, 
      #{makebilltime,jdbcType=BIGINT}, #{remarks,jdbcType=VARCHAR}, #{creator,jdbcType=VARCHAR}, 
      #{createtime,jdbcType=BIGINT}, #{modifier,jdbcType=VARCHAR}, #{modifytime,jdbcType=BIGINT},
      #{startloadingtime,jdbcType=BIGINT}, #{endloadingtime,jdbcType=BIGINT}, #{sealtime,jdbcType=BIGINT},
      #{forceOutFactory,jdbcType=BIT}, #{forceOutFactoryPerson,jdbcType=VARCHAR}, #{forceOutFactoryTime,jdbcType=BIGINT}, 
      #{validStatus,jdbcType=VARCHAR}, #{sendPerson,jdbcType=VARCHAR}, #{sendPersonName,jdbcType=VARCHAR}, 
      #{sendTime,jdbcType=BIGINT}, #{sendID,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesArrive" >
    insert into tr_sales_db_arrive
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="auditstatus != null" >
        auditstatus,
      </if>
      <if test="source != null" >
        source,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="vehicleid != null" >
        vehicleid,
      </if>
      <if test="vehicleno != null" >
        vehicleno,
      </if>
      <if test="vehiclerfid != null" >
        vehiclerfid,
      </if>
      <if test="driverid != null" >
        driverid,
      </if>
      <if test="drivername != null" >
        drivername,
      </if>
      <if test="driveridentityno != null" >
        driveridentityno,
      </if>
      <if test="billid != null" >
        billid,
      </if>
      <if test="billcode != null" >
        billcode,
      </if>
      <if test="billdetailid != null" >
        billdetailid,
      </if>
      <if test="abnormalperson != null" >
        abnormalperson,
      </if>
      <if test="abnormalpersonname != null" >
        abnormalpersonname,
      </if>
      <if test="abnormaltime != null" >
        abnormaltime,
      </if>
      <if test="unit != null" >
        unit,
      </if>
      <if test="takeamount != null" >
        takeamount,
      </if>
      <if test="actualtakeamount != null" >
        actualtakeamount,
      </if>
      <if test="spraycode != null" >
        spraycode,
      </if>
      <if test="serialnumber != null" >
        serialnumber,
      </if>
      <if test="icardid != null" >
        icardid,
      </if>
      <if test="icardno != null" >
        icardno,
      </if>
      <if test="state != null" >
        state,
      </if>
      <if test="maindeduction != null" >
        maindeduction,
      </if>
      <if test="makerid != null" >
        makerid,
      </if>
      <if test="makebillname != null" >
        makebillname,
      </if>
      <if test="makebilltime != null" >
        makebilltime,
      </if>
      <if test="remarks != null" >
        remarks,
      </if>
      <if test="creator != null" >
        creator,
      </if>
      <if test="createtime != null" >
        createtime,
      </if>
      <if test="modifier != null" >
        modifier,
      </if>
      <if test="modifytime != null" >
        modifytime,
      </if>
      <if test="startloadingtime != null" >
        startloadingtime,
      </if>
      <if test="endloadingtime != null" >
        endloadingtime,
      </if>
      <if test="sealtime != null" >
        sealtime,
      </if>
      <if test="forceOutFactory != null" >
        forceOutFactory,
      </if>
      <if test="forceOutFactoryPerson != null" >
        forceOutFactoryPerson,
      </if>
      <if test="forceOutFactoryTime != null" >
        forceOutFactoryTime,
      </if>
      <if test="validStatus != null" >
        validStatus,
      </if>
      <if test="sendPerson != null" >
        sendPerson,
      </if>
      <if test="sendPersonName != null" >
        sendPersonName,
      </if>
      <if test="sendTime != null" >
        sendTime,
      </if>
      <if test="sendID != null" >
        sendID,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="auditstatus != null" >
        #{auditstatus,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        #{source,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="vehicleid != null" >
        #{vehicleid,jdbcType=VARCHAR},
      </if>
      <if test="vehicleno != null" >
        #{vehicleno,jdbcType=VARCHAR},
      </if>
      <if test="vehiclerfid != null" >
        #{vehiclerfid,jdbcType=VARCHAR},
      </if>
      <if test="driverid != null" >
        #{driverid,jdbcType=VARCHAR},
      </if>
      <if test="drivername != null" >
        #{drivername,jdbcType=VARCHAR},
      </if>
      <if test="driveridentityno != null" >
        #{driveridentityno,jdbcType=VARCHAR},
      </if>
      <if test="billid != null" >
        #{billid,jdbcType=VARCHAR},
      </if>
      <if test="billcode != null" >
        #{billcode,jdbcType=VARCHAR},
      </if>
      <if test="billdetailid != null" >
        #{billdetailid,jdbcType=VARCHAR},
      </if>
      <if test="abnormalperson != null" >
        #{abnormalperson,jdbcType=VARCHAR},
      </if>
      <if test="abnormalpersonname != null" >
        #{abnormalpersonname,jdbcType=VARCHAR},
      </if>
      <if test="abnormaltime != null" >
        #{abnormaltime,jdbcType=BIGINT},
      </if>
      <if test="unit != null" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="takeamount != null" >
        #{takeamount,jdbcType=DOUBLE},
      </if>
      <if test="actualtakeamount != null" >
        #{actualtakeamount,jdbcType=DOUBLE},
      </if>
      <if test="spraycode != null" >
        #{spraycode,jdbcType=VARCHAR},
      </if>
      <if test="serialnumber != null" >
        #{serialnumber,jdbcType=VARCHAR},
      </if>
      <if test="icardid != null" >
        #{icardid,jdbcType=VARCHAR},
      </if>
      <if test="icardno != null" >
        #{icardno,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="maindeduction != null" >
        #{maindeduction,jdbcType=VARCHAR},
      </if>
      <if test="makerid != null" >
        #{makerid,jdbcType=VARCHAR},
      </if>
      <if test="makebillname != null" >
        #{makebillname,jdbcType=VARCHAR},
      </if>
      <if test="makebilltime != null" >
        #{makebilltime,jdbcType=BIGINT},
      </if>
      <if test="remarks != null" >
        #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=BIGINT},
      </if>
      <if test="modifier != null" >
        #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="modifytime != null" >
        #{modifytime,jdbcType=BIGINT},
      </if>
      <if test="startloadingtime != null" >
        #{startloadingtime,jdbcType=BIGINT},
      </if>
      <if test="endloadingtime != null" >
        #{endloadingtime,jdbcType=BIGINT},
      </if>
      <if test="sealtime != null" >
        #{sealtime,jdbcType=BIGINT},
      </if>
      <if test="forceOutFactory != null" >
        #{forceOutFactory,jdbcType=BIT},
      </if>
      <if test="forceOutFactoryPerson != null" >
        #{forceOutFactoryPerson,jdbcType=VARCHAR},
      </if>
      <if test="forceOutFactoryTime != null" >
        #{forceOutFactoryTime,jdbcType=BIGINT},
      </if>
      <if test="validStatus != null" >
        #{validStatus,jdbcType=VARCHAR},
      </if>
      <if test="sendPerson != null" >
        #{sendPerson,jdbcType=VARCHAR},
      </if>
      <if test="sendPersonName != null" >
        #{sendPersonName,jdbcType=VARCHAR},
      </if>
      <if test="sendTime != null" >
        #{sendTime,jdbcType=BIGINT},
      </if>
      <if test="sendID != null" >
        #{sendID,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesArrive" >
    update tr_sales_db_arrive
    <set >
      <if test="code != null" >
        code = #{code,jdbcType=VARCHAR},
      </if>
      <if test="auditstatus != null" >
        auditstatus = #{auditstatus,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        source = #{source,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="vehicleid != null" >
        vehicleid = #{vehicleid,jdbcType=VARCHAR},
      </if>
      <if test="vehicleno != null" >
        vehicleno = #{vehicleno,jdbcType=VARCHAR},
      </if>
      <if test="vehiclerfid != null" >
        vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR},
      </if>
      <if test="driverid != null" >
        driverid = #{driverid,jdbcType=VARCHAR},
      </if>
      <if test="drivername != null" >
        drivername = #{drivername,jdbcType=VARCHAR},
      </if>
      <if test="driveridentityno != null" >
        driveridentityno = #{driveridentityno,jdbcType=VARCHAR},
      </if>
      <if test="billid != null" >
        billid = #{billid,jdbcType=VARCHAR},
      </if>
      <if test="billcode != null" >
        billcode = #{billcode,jdbcType=VARCHAR},
      </if>
      <if test="billdetailid != null" >
        billdetailid = #{billdetailid,jdbcType=VARCHAR},
      </if>
      <if test="abnormalperson != null" >
        abnormalperson = #{abnormalperson,jdbcType=VARCHAR},
      </if>
      <if test="abnormalpersonname != null" >
        abnormalpersonname = #{abnormalpersonname,jdbcType=VARCHAR},
      </if>
      <if test="abnormaltime != null" >
        abnormaltime = #{abnormaltime,jdbcType=BIGINT},
      </if>
      <if test="unit != null" >
        unit = #{unit,jdbcType=VARCHAR},
      </if>
      <if test="takeamount != null" >
        takeamount = #{takeamount,jdbcType=DOUBLE},
      </if>
      <if test="actualtakeamount != null" >
        actualtakeamount = #{actualtakeamount,jdbcType=DOUBLE},
      </if>
      <if test="spraycode != null" >
        spraycode = #{spraycode,jdbcType=VARCHAR},
      </if>
      <if test="serialnumber != null" >
        serialnumber = #{serialnumber,jdbcType=VARCHAR},
      </if>
      <if test="icardid != null" >
        icardid = #{icardid,jdbcType=VARCHAR},
      </if>
      <if test="icardno != null" >
        icardno = #{icardno,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=VARCHAR},
      </if>
      <if test="maindeduction != null" >
        maindeduction = #{maindeduction,jdbcType=VARCHAR},
      </if>
      <if test="makerid != null" >
        makerid = #{makerid,jdbcType=VARCHAR},
      </if>
      <if test="makebillname != null" >
        makebillname = #{makebillname,jdbcType=VARCHAR},
      </if>
      <if test="makebilltime != null" >
        makebilltime = #{makebilltime,jdbcType=BIGINT},
      </if>
      <if test="remarks != null" >
        remarks = #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        creator = #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        createtime = #{createtime,jdbcType=BIGINT},
      </if>
      <if test="modifier != null" >
        modifier = #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="modifytime != null" >
        modifytime = #{modifytime,jdbcType=BIGINT},
      </if>
      <if test="startloadingtime != null" >
        startloadingtime = #{startloadingtime,jdbcType=BIGINT},
      </if>
      <if test="endloadingtime != null" >
        endloadingtime = #{endloadingtime,jdbcType=BIGINT},
      </if>
      <if test="sealtime != null" >
        sealtime = #{sealtime,jdbcType=BIGINT},
      </if>
      <if test="forceOutFactory != null" >
        forceOutFactory = #{forceOutFactory,jdbcType=BIT},
      </if>
      <if test="forceOutFactoryPerson != null" >
        forceOutFactoryPerson = #{forceOutFactoryPerson,jdbcType=VARCHAR},
      </if>
      <if test="forceOutFactoryTime != null" >
        forceOutFactoryTime = #{forceOutFactoryTime,jdbcType=BIGINT},
      </if>
      <if test="validStatus != null" >
        validStatus = #{validStatus,jdbcType=VARCHAR},
      </if>
      <if test="sendPerson != null" >
        sendPerson = #{sendPerson,jdbcType=VARCHAR},
      </if>
      <if test="sendPersonName != null" >
        sendPersonName = #{sendPersonName,jdbcType=VARCHAR},
      </if>
      <if test="sendTime != null" >
        sendTime = #{sendTime,jdbcType=BIGINT},
      </if>
      <if test="sendID != null" >
        sendID = #{sendID,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesArrive" >
    update tr_sales_db_arrive
    set code = #{code,jdbcType=VARCHAR},
      auditstatus = #{auditstatus,jdbcType=VARCHAR},
      source = #{source,jdbcType=VARCHAR},
      status = #{status,jdbcType=VARCHAR},
      vehicleid = #{vehicleid,jdbcType=VARCHAR},
      vehicleno = #{vehicleno,jdbcType=VARCHAR},
      vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR},
      driverid = #{driverid,jdbcType=VARCHAR},
      drivername = #{drivername,jdbcType=VARCHAR},
      driveridentityno = #{driveridentityno,jdbcType=VARCHAR},
      billid = #{billid,jdbcType=VARCHAR},
      billcode = #{billcode,jdbcType=VARCHAR},
      billdetailid = #{billdetailid,jdbcType=VARCHAR},
      abnormalperson = #{abnormalperson,jdbcType=VARCHAR},
      abnormalpersonname = #{abnormalpersonname,jdbcType=VARCHAR},
      abnormaltime = #{abnormaltime,jdbcType=BIGINT},
      unit = #{unit,jdbcType=VARCHAR},
      takeamount = #{takeamount,jdbcType=DOUBLE},
      actualtakeamount = #{actualtakeamount,jdbcType=DOUBLE},
      spraycode = #{spraycode,jdbcType=VARCHAR},
      serialnumber = #{serialnumber,jdbcType=VARCHAR},
      icardid = #{icardid,jdbcType=VARCHAR},
      icardno = #{icardno,jdbcType=VARCHAR},
      state = #{state,jdbcType=VARCHAR},
      maindeduction = #{maindeduction,jdbcType=VARCHAR},
      makerid = #{makerid,jdbcType=VARCHAR},
      makebillname = #{makebillname,jdbcType=VARCHAR},
      makebilltime = #{makebilltime,jdbcType=BIGINT},
      remarks = #{remarks,jdbcType=VARCHAR},
      creator = #{creator,jdbcType=VARCHAR},
      createtime = #{createtime,jdbcType=BIGINT},
      modifier = #{modifier,jdbcType=VARCHAR},
      modifytime = #{modifytime,jdbcType=BIGINT},
      startloadingtime = #{startloadingtime,jdbcType=BIGINT},
      endloadingtime = #{endloadingtime,jdbcType=BIGINT},
      sealtime = #{sealtime,jdbcType=BIGINT},
      forceOutFactory = #{forceOutFactory,jdbcType=BIT},
      forceOutFactoryPerson = #{forceOutFactoryPerson,jdbcType=VARCHAR},
      forceOutFactoryTime = #{forceOutFactoryTime,jdbcType=BIGINT},
      validStatus = #{validStatus,jdbcType=VARCHAR},
      sendPerson = #{sendPerson,jdbcType=VARCHAR},
      sendPersonName = #{sendPersonName,jdbcType=VARCHAR},
      sendTime = #{sendTime,jdbcType=BIGINT},
      sendID = #{sendID,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <select id="selectSelective" resultMap="BaseResultMap" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesArrive">
  	select
  	<include refid="Base_Column_List" />
  	from tr_sales_db_arrive
  	<where>
  	  <if test="id != null and id != ''" >
        and id = #{id,jdbcType=VARCHAR}
      </if>
  	  <if test="code != null and code != ''" >
        and code = #{code,jdbcType=VARCHAR}
      </if>
      <if test="auditstatus != null and auditstatus != ''" >
        and auditstatus = #{auditstatus,jdbcType=VARCHAR}
      </if>
      <if test="source != null and source != ''" >
        and source = #{source,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != ''" >
        and status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != ''" >
        and vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="vehicleno != null and vehicleno != ''" >
        and vehicleno = #{vehicleno,jdbcType=VARCHAR}
      </if>
      <if test="vehiclerfid != null and vehiclerfid != ''" >
        and vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR}
      </if>
      <if test="driverid != null and driverid != ''" >
        and driverid = #{driverid,jdbcType=VARCHAR}
      </if>
      <if test="drivername != null and drivername != ''" >
        and drivername = #{drivername,jdbcType=VARCHAR}
      </if>
      <if test="driveridentityno != null and driveridentityno != ''" >
        and driveridentityno = #{driveridentityno,jdbcType=VARCHAR}
      </if>
      <if test="billid != null and billid != ''" >
        and billid = #{billid,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != ''" >
        and billcode = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="billdetailid != null and billdetailid != ''" >
        and billdetailid = #{billdetailid,jdbcType=VARCHAR}
      </if>
      <if test="abnormalperson != null and abnormalperson != ''" >
        and abnormalperson = #{abnormalperson,jdbcType=VARCHAR}
      </if>
      <if test="abnormalpersonname != null and abnormalpersonname != ''" >
        and abnormalpersonname = #{abnormalpersonname,jdbcType=VARCHAR}
      </if>
      <if test="abnormaltime != null and abnormaltime != ''" >
        and abnormaltime = #{abnormaltime,jdbcType=BIGINT}
      </if>
      <if test="unit != null and unit != ''" >
        and unit = #{unit,jdbcType=VARCHAR}
      </if>
      <if test="takeamount != null and takeamount != ''" >
        and takeamount = #{takeamount,jdbcType=DOUBLE}
      </if>
      <if test="actualtakeamount != null and actualtakeamount != ''" >
        and actualtakeamount = #{actualtakeamount,jdbcType=DOUBLE}
      </if>
      <if test="spraycode != null and spraycode != ''" >
        and spraycode = #{spraycode,jdbcType=VARCHAR}
      </if>
      <if test="serialnumber != null and serialnumber != ''" >
        and serialnumber = #{serialnumber,jdbcType=VARCHAR}
      </if>
      <if test="icardid != null and icardid != ''" >
        and icardid = #{icardid,jdbcType=VARCHAR}
      </if>
      <if test="icardno != null and icardno != ''" >
        and icardno = #{icardno,jdbcType=VARCHAR}
      </if>
      <if test="state != null and state != ''" >
        and state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="maindeduction != null and maindeduction != ''" >
        and maindeduction = #{maindeduction,jdbcType=VARCHAR}
      </if>
      <if test="makerid != null and makerid != ''" >
        and makerid = #{makerid,jdbcType=VARCHAR}
      </if>
      <if test="makebillname != null and makebillname != ''" >
        and makebillname = #{makebillname,jdbcType=VARCHAR}
      </if>
      <if test="makebilltime != null and makebilltime != ''" >
        and makebilltime = #{makebilltime,jdbcType=BIGINT}
      </if>
      <if test="remarks != null and remarks != ''" >
        and remarks = #{remarks,jdbcType=VARCHAR}
      </if>
      <if test="creator != null and creator != ''" >
        and creator = #{creator,jdbcType=VARCHAR}
      </if>
      <if test="createtime != null and createtime != ''" >
        and createtime = #{createtime,jdbcType=BIGINT}
      </if>
      <if test="modifier != null and modifier != ''" >
        and modifier = #{modifier,jdbcType=VARCHAR}
      </if>
      <if test="modifytime != null and modifytime != ''" >
        and modifytime = #{modifytime,jdbcType=BIGINT}
      </if>
      <if test="startloadingtime != null and startloadingtime != ''" >
        and startloadingtime = #{startloadingtime,jdbcType=BIGINT}
      </if>
      <if test="endloadingtime != null and endloadingtime != ''" >
        and endloadingtime = #{endloadingtime,jdbcType=BIGINT}
      </if>
      <if test="sealtime != null and sealtime != ''" >
        and sealtime = #{sealtime,jdbcType=BIGINT}
      </if>
      <if test="forceOutFactory != null and forceOutFactory != ''" >
        and forceOutFactory = #{forceOutFactory,jdbcType=BIT}
      </if>
      <if test="forceOutFactoryPerson != null and forceOutFactoryPerson != ''" >
        and forceOutFactoryPerson = #{forceOutFactoryPerson,jdbcType=VARCHAR}
      </if>
      <if test="forceOutFactoryTime != null and forceOutFactoryTime != ''" >
        and forceOutFactoryTime = #{forceOutFactoryTime,jdbcType=BIGINT}
      </if>
      <if test="validStatus != null and validStatus != ''" >
        and validStatus = #{validStatus,jdbcType=VARCHAR}
      </if>
      <if test="sendPerson != null and sendPerson != ''" >
        and sendPerson = #{sendPerson,jdbcType=VARCHAR}
      </if>
      <if test="sendPersonName != null and sendPersonName != ''" >
        and sendPersonName = #{sendPersonName,jdbcType=VARCHAR}
      </if>
      <if test="sendTime != null and sendTime != ''" >
        and sendTime = #{sendTime,jdbcType=BIGINT}
      </if>
      <if test="sendID != null and sendID != ''" >
        and sendID = #{sendID,jdbcType=VARCHAR}
      </if>
  	</where>
  </select>
  <select id="findSalesArrivePage" resultMap="BaseResultMap" parameterType="com.tianrui.api.req.businessManage.salesManage.SalesArriveQuery">
  	select s1.*
  	from tr_sales_db_arrive s1 left join tr_sales_db_application s2 
  	on s1.billid = s2.id
  	left join tr_sales_db_application_detail s3
  	on s2.id = s3.salesid
  	<where>
      <if test="state != null and state != '' ">
        and s1.state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="code != null and code != '' ">
        and s1.code = #{code,jdbcType=VARCHAR}
      </if>
  	  <if test="auditstatus != null and auditstatus != '' ">
        and s1.auditstatus = #{auditstatus,jdbcType=VARCHAR}
      </if>
      <if test="source != null and source != '' ">
        and s1.source = #{source,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != '' ">
        and s1.status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != '' ">
        and s1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="vehicleno != null and vehicleno != '' ">
        and s1.vehicleno = #{vehicleno,jdbcType=VARCHAR}
      </if>
      <if test="driverid != null and driverid != '' ">
        and s1.driverid = #{driverid,jdbcType=VARCHAR}
      </if>
      <if test="customerid != null and customerid != '' ">
        and s2.customerid = #{customerid,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != '' ">
        and s2.code = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="materielid != null and materielid != '' ">
        and s3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
      <if test="starttime != null and starttime != ''">
		and s1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and s1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  	order by makebilltime desc
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="findSalesArrivePageCount" resultType="java.lang.Long" parameterType="com.tianrui.api.req.businessManage.salesManage.SalesArriveQuery">
  	select count(0)
  	from tr_sales_db_arrive s1 left join tr_sales_db_application s2 
  	on s1.billid = s2.id
  	left join tr_sales_db_application_detail s3
  	on s2.id = s3.salesid
  	<where>
      <if test="state != null and state != '' ">
        and s1.state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="code != null and code != '' ">
        and s1.code = #{code,jdbcType=VARCHAR}
      </if>
  	  <if test="auditstatus != null and auditstatus != '' ">
        and s1.auditstatus = #{auditstatus,jdbcType=VARCHAR}
      </if>
      <if test="source != null and source != '' ">
        and s1.source = #{source,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != '' ">
        and s1.status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != '' ">
        and s1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="vehicleno != null and vehicleno != '' ">
        and s1.vehicleno = #{vehicleno,jdbcType=VARCHAR}
      </if>
      <if test="driverid != null and driverid != '' ">
        and s1.driverid = #{driverid,jdbcType=VARCHAR}
      </if>
      <if test="customerid != null and customerid != '' ">
        and s2.customerid = #{customerid,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != '' ">
        and s2.code = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="materielid != null and materielid != '' ">
        and s3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
      <if test="starttime != null and starttime != ''">
		and s1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and s1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  </select>
  <select id="checkDriverAndVehicleIsUse" resultMap="BaseResultMap" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesArrive">
  	select 
	<include refid="Base_Column_List" />
  	from tr_sales_db_arrive
  	<where>
  		status != '5' and status != '3' and state = '1'
  		<if test="id != null and id != ''">
  			and id != #{id,jdbcType=VARCHAR}
  		</if>
  		<if test="driverid != null and driverid != ''">
  			and driverid = #{driverid,jdbcType=VARCHAR}
  		</if>
  		<if test="vehicleid != null and vehicleid != ''">
  			and vehicleid = #{vehicleid,jdbcType=VARCHAR}
  		</if>
  	</where>
  </select>
  <select id="checkICUse" parameterType="java.lang.String" resultMap="BaseResultMap">
  	select 
  	<include refid="Base_Column_List" />
  	from tr_sales_db_arrive
  	where icardid = #{icardid,jdbcType=VARCHAR} and state = '1' and status != '5' and status != '3'
  </select>
  <select id="selectWaitingNumber" resultType="java.lang.Integer" parameterType="com.tianrui.api.req.businessManage.salesManage.SalesArriveQuery">
  	select count(0)
	from tr_sales_db_arrive a1 
	left join tr_sales_db_application a2 on a1.billid = a2.id
	left join tr_sales_db_application_detail a3 on a2.id = a3.salesid
	left join tr_materiel_db_manage m on a3.materielid = m.id
	where a1.`status` != 0 and a1.`status` != 5 and a1.`status` != 3 and a1.state = '1'
	<if test="materielid != null and materielid != ''">
		and a3.materielid = #{materielid,jdbcType=VARCHAR}
	</if>
	<if test="packagetype != null and packagetype != ''">
		and m.packagetype = #{packagetype,jdbcType=VARCHAR}
	</if>
  </select>
  <select id="selectByIds" parameterType="java.util.List" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_sales_db_arrive
  	where id in
	<foreach item="item" index="index" collection="list" open="(" separator="," close=")">  
		#{item}  
	</foreach>
  </select>
  <select id="hasSalesArrive" resultMap="BaseResultMap" parameterType="java.lang.String" >
    SELECT
		<include refid="Base_Column_List" />
	FROM
		tr_sales_db_arrive
	WHERE
		vehicleno = #{vehicleno,jdbcType=VARCHAR}
	AND state = '1'
	AND status != '3' and validStatus = 0
	AND (
		status != '5'
		OR forceOutFactory = 1
	)
	</select>
  <select id="selectByCode" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_sales_db_arrive
    where code = #{code,jdbcType=VARCHAR}
  </select>
  <select id="validNoticeByVehicle" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_sales_db_arrive
    where vehicleno = #{vehicleno,jdbcType=VARCHAR} and vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR} 
    	and status != '3' and validStatus = 0 and (status != '5' or forceOutFactory = 1) and state = '1'
  </select>
  <select id="findAppNoticePage" resultType="com.tianrui.api.resp.businessManage.app.AppNoticeOrderResp" parameterType="com.tianrui.api.req.businessManage.app.AppNoticeOrderReq">
  	select s1.id, s1.code, s1.billcode as billCode, s2.billtime, s1.makebilltime as noticetime, s1.vehicleno, 
  		s3.materielname as materialName, s2.customername as customerName, s1.takeamount as number, s1.source, s1.status
  	from tr_sales_db_arrive s1 
  	left join tr_sales_db_application s2 on s1.billid = s2.id
  	left join tr_sales_db_application_detail s3 on s2.id = s3.salesid
  	<where>
      <if test="code != null and code != '' ">
        and s1.code = #{code,jdbcType=VARCHAR}
      </if>
      <if test="state != null and state != '' ">
        and s1.state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != '' ">
        and s1.status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != '' ">
        and s2.code = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != '' ">
        and s1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="materielid != null and materielid != '' ">
        and s3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
      <if test="userId != null and userId != '' ">
        and s1.makerid = #{userId,jdbcType=VARCHAR}
      </if>
      <if test="starttime != null and starttime != ''">
		and s1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and s1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  	<if test="orderColumn != null and orderColumn != ''">
  		order by ${orderColumn} 
  		<choose>
  			<when test="orderAsc == 'DESC'">
  				DESC
  			</when>
  			<otherwise>
  				ASC
  			</otherwise>
  		</choose>
  	</if>
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="findAppNoticePageCount" resultType="java.lang.Long" parameterType="com.tianrui.api.req.businessManage.app.AppNoticeOrderReq">
  	select count(0)
  	from tr_sales_db_arrive s1 
  	left join tr_sales_db_application s2 on s1.billid = s2.id
  	left join tr_sales_db_application_detail s3 on s2.id = s3.salesid
  	<where>
      <if test="code != null and code != '' ">
        and s1.code = #{code,jdbcType=VARCHAR}
      </if>
      <if test="state != null and state != '' ">
        and s1.state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != '' ">
        and s1.status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != '' ">
        and s2.code = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != '' ">
        and s1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="materielid != null and materielid != '' ">
        and s3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
      <if test="userId != null and userId != '' ">
        and s1.makerid = #{userId,jdbcType=VARCHAR}
      </if>
      <if test="starttime != null and starttime != ''">
		and s1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and s1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  </select>
  <select id="appInfoFactoryVehicleAndMaterial" parameterType="com.tianrui.api.req.businessManage.app.AppOrderReq" resultType="com.tianrui.api.resp.businessManage.app.AppVehicleInFactoryResp">
  	select s3.materielname as materName, count(s1.vehicleno) as vehicleCount
	from tr_sales_db_arrive s1
		left join tr_sales_db_application s2 on s1.billid = s2.id
		left join tr_sales_db_application_detail s3 on s1.billdetailid = s3.id
	<where>
  	  <if test="state != null and state !=''" >
        and s1.state = #{state,jdbcType=VARCHAR}
      </if>
  	  <if test="userId != null and userId !=''" >
        and s2.customerid = #{userId,jdbcType=VARCHAR}
      </if>
	</where>
	group by s3.materielname
  </select>
  <select id="selectLogisticsPage" parameterType="com.tianrui.api.req.businessManage.logisticsManage.SalesLogisticsQuery" resultType="com.tianrui.api.resp.businessManage.logisticsManage.SalesLogisticsResp">
	  SELECT
		t1. CODE AS noticeCode,
		t2.customername AS customerName,
		t3.materielname AS materialName,
		t1.vehicleno AS vehicleNo,
		t2. CODE AS billCode,
		t2.makebilltime AS noticeTime,
		t4.entertime AS enterTime,
		t5.lighttime AS lightTime,
		t5.weighttime AS weightTime,
		t1.startloadingtime AS startLoadingTime,
		t1.endloadingtime AS endLoadingTime,
		t1.sealtime AS sealTime,
		t4.outtime AS outTime
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_sales_db_application_detail t3 ON t1.billdetailid = t3.id
	LEFT JOIN tr_access_db_record t4 ON t1.id = t4.noticeid
	LEFT JOIN tr_pound_db_note t5 ON t1.id = t5.noticeid
	where t1.state = '1'
  	  <if test="customerId != null and customerId !=''" >
        and t2.customerid = #{customerId,jdbcType=VARCHAR}
      </if>
  	  <if test="materielId != null and materielId !=''" >
        and t3.materielid = #{materielId,jdbcType=VARCHAR}
      </if>
  	  <if test="vehicleId != null and vehicleId !=''" >
        and t1.vehicleid = #{vehicleId,jdbcType=VARCHAR}
      </if>
  	  <if test="billCode != null and billCode !=''" >
        and t1.billcode = #{billCode,jdbcType=VARCHAR}
      </if>
  	  <if test="noticeCode != null and noticeCode !=''" >
        and t1.code = #{noticeCode,jdbcType=VARCHAR}
      </if>
      order by t1.createtime desc
	  <if test="start != null and start >= 0">
		  <if test="limit != null">
			  limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
		  </if>
	  </if>
  </select>
  <select id="selectLogisticsPageCount" parameterType="com.tianrui.api.req.businessManage.logisticsManage.SalesLogisticsQuery" resultType="java.lang.Long">
  	SELECT
		count(0)
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_sales_db_application_detail t3 ON t1.billdetailid = t3.id
	LEFT JOIN tr_access_db_record t4 ON t1.id = t4.noticeid
	LEFT JOIN tr_pound_db_note t5 ON t1.id = t5.noticeid
	where t1.state = '1'
  	  <if test="customerId != null and customerId !=''" >
        and t2.customerid = #{customerId,jdbcType=VARCHAR}
      </if>
  	  <if test="materielId != null and materielId !=''" >
        and t3.materielid = #{materielId,jdbcType=VARCHAR}
      </if>
  	  <if test="vehicleId != null and vehicleId !=''" >
        and t1.vehicleid = #{vehicleId,jdbcType=VARCHAR}
      </if>
  	  <if test="billCode != null and billCode !=''" >
        and t1.billcode = #{billCode,jdbcType=VARCHAR}
      </if>
  	  <if test="noticeCode != null and noticeCode !=''" >
        and t1.code = #{noticeCode,jdbcType=VARCHAR}
      </if>
  </select>
  <select id="getByVehicleId" parameterType="java.lang.String" resultMap="BaseResultMap">
    select <include refid="Base_Column_List"/>
    from tr_sales_db_arrive
    where status not in ('3', '5') and state = 1 and vehicleid = #{vehicleId,jdbcType=VARCHAR}
  </select>
  <select id="getByVehicleNo" parameterType="java.lang.String" resultMap="BaseResultMap">
    select <include refid="Base_Column_List"/>
    from tr_sales_db_arrive
    where status not in ('3', '5') and state = 1 and vehicleno = #{vehicleNo,jdbcType=VARCHAR}
  </select>
  <select id="emptyForceOutFactoryByVehicle" parameterType="java.lang.String">
	UPDATE
		tr_sales_db_arrive
	SET forceOutFactory = 0
	WHERE
		vehicleid = #{vehicleId,jdbcType=VARCHAR}
	AND STATUS = 5
	AND forceOutFactory = 1
	AND state = 1
  </select>
  <select id="appHomeNotice" parameterType="com.tianrui.api.req.android.HomePageParam" resultType="com.tianrui.api.resp.android.HomeNoticeVo">
  	SELECT
		t1.id,
		t1.`code`,
		t1.vehicleno AS vehicle,
		t1.drivername AS driver,
		FROM_UNIXTIME(
			t2.billtime / 1000,
			"%Y-%m-%d"
		) AS billTime
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	WHERE
		t1.auditstatus = 1
	AND t1.validStatus = 0
	AND t2.customerid = #{ncId,jdbcType=VARCHAR}
	AND t2.orgid = #{salesOrg,jdbcType=VARCHAR}
	AND t2.state = 1
	AND t2.`status` = 1
	ORDER BY
		t2.billtime DESC
  </select>
  <select id="appHomeVehicle" parameterType="com.tianrui.api.req.android.HomePageParam" resultType="java.lang.String">
  	SELECT
		t1.vehicleno
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	WHERE
		t1.auditstatus = 1
	AND t1.`status` IN (1, 2, 4, 6, 7)
	AND t2.customerid = #{ncId,jdbcType=VARCHAR}
	AND t2.orgid = #{salesOrg,jdbcType=VARCHAR}
	AND t2.state = 1
	AND t2.`status` = 1
	ORDER BY
		t2.billtime DESC
  </select>
  <select id="appNoticeList" parameterType="com.tianrui.api.req.android.NoticeListParam" resultType="com.tianrui.api.resp.android.NoticeListVo">
  	SELECT
		t1.id,
		t1.`code`,
		FROM_UNIXTIME(
			IF(t1.modifytime is null, t2.billtime, t1.modifytime) / 1000,
			'%Y-%m-%d'
		) as billTime,
		t1.vehicleno AS vehicle,
		t3.materielname AS material,
		t1.drivername AS driver,
		t1.takeamount number,
		t3.margin,
		CASE
		WHEN t1.`status` = 0 THEN
			'未入厂'
		WHEN t1.`status` = 1 THEN
			'一次过磅'
		WHEN t1.`status` = 2 THEN
			'二次过磅'
		WHEN t1.`status` = 3 THEN
			'作废'
		WHEN t1.`status` = 4 THEN
			'发卡'
		WHEN t1.`status` = 5
		AND t1.forceOutFactory = 0 THEN
			'出厂'
		WHEN t1.`status` = 5
		AND t1.forceOutFactory = 1 THEN
			'强制出厂'
		WHEN t1.`status` = 6 THEN
			'入厂'
		WHEN t1.`status` = 7 THEN
			'装车'
		ELSE
			''
		END AS status,
		t2.billtypeid AS billType,
		IF (COUNT(t4.notice_id) = 1, 1, 2) AS noticeType
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_sales_db_application_detail t3 ON t1.billdetailid = t3.id
	LEFT JOIN tr_sales_application_arrive t4 ON t1.id = t4.notice_id
	WHERE
		t1.state = 1
	AND t1.`status` != 3
	AND t1.validStatus = 0
	AND t2.customerid = #{ncId, jdbcType=VARCHAR}
	AND t2.orgid = #{salesOrg, jdbcType=VARCHAR}
	<choose>
		<when test="type == 0">
			and t1.auditstatus = 0
		</when>
		<when test="type == 1">
			and t1.auditstatus = 1 and t1.`status` = 0
		</when>
		<when test="type == 2">
			and t1.auditstatus = 1 and t1.`status` in (1,2,4,6,7)
		</when>
		<when test="type == 3">
			and t1.auditstatus = 1 and t1.`status` = 5
		</when>
		<otherwise></otherwise>
	</choose>
	<if test="code != null and code != ''">
		AND t1.`code` = #{code,jdbcType=VARCHAR}
	</if>
	<if test="vehicle != null and vehicle != ''">
		AND (t1.vehicleid = #{vehicle,jdbcType=VARCHAR}
			OR 
			t1.vehicleno = #{vehicle,jdbcType=VARCHAR})
	</if>
	<if test="driver != null and driver != ''">
		AND (t1.driverid = #{driver,jdbcType=VARCHAR}
			OR 
			t1.drivername = #{driver,jdbcType=VARCHAR})
	</if>
	<if test="material != null and material != ''">
		AND (t3.materielid = #{material,jdbcType=VARCHAR}
			OR 
			t3.materielname = #{material,jdbcType=VARCHAR})
	</if>
	<if test="source != null and source != ''">
		AND t1.source = #{source,jdbcType=VARCHAR}
	</if>
	<if test="startTime != null">
		and t2.billtime <![CDATA[>=]]> #{startTime, jdbcType=BIGINT}
	</if>
	<if test="endTime != null">
		and t2.billtime <![CDATA[<]]> #{endTime, jdbcType=BIGINT}
	</if>
	GROUP BY t4.notice_id
	ORDER BY t1.createtime DESC
	<if test="start != null and start >= 0">
        <if test="limit != null">
            limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
        </if>
    </if>
  </select>
  <select id="appNoticeListCount" parameterType="com.tianrui.api.req.android.NoticeListParam" resultType="java.lang.Long">
  	SELECT
		count(0)
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_sales_db_application_detail t3 ON t1.billdetailid = t3.id
	WHERE
		t1.state = 1
	AND t1.`status` != 3
	AND t1.validStatus = 0
	AND t2.customerid = #{ncId, jdbcType=VARCHAR}
	AND t2.orgid = #{salesOrg, jdbcType=VARCHAR}
	<choose>
		<when test="type == 0">
			and t1.auditstatus = 0
		</when>
		<when test="type == 1">
			and t1.auditstatus = 1 and t1.`status` = 0
		</when>
		<when test="type == 2">
			and t1.auditstatus = 1 and t1.`status` in (1,2,4,6,7)
		</when>
		<when test="type == 3">
			and t1.auditstatus = 1 and t1.`status` = 5
		</when>
		<otherwise></otherwise>
	</choose>
	<if test="code != null and code != ''">
		AND t1.`code` = #{code,jdbcType=VARCHAR}
	</if>
	<if test="vehicle != null and vehicle != ''">
		AND (t1.vehicleid = #{vehicle,jdbcType=VARCHAR}
			OR 
			t1.vehicleno = #{vehicle,jdbcType=VARCHAR})
	</if>
	<if test="driver != null and driver != ''">
		AND (t1.driverid = #{driver,jdbcType=VARCHAR}
			OR 
			t1.drivername = #{driver,jdbcType=VARCHAR})
	</if>
	<if test="material != null and material != ''">
		AND (t3.materielid = #{material,jdbcType=VARCHAR}
			OR 
			t3.materielname = #{material,jdbcType=VARCHAR})
	</if>
	<if test="source != null and source != ''">
		AND t1.source = #{source,jdbcType=VARCHAR}
	</if>
	<if test="startTime != null">
		and t2.billtime <![CDATA[>=]]> #{startTime, jdbcType=BIGINT}
	</if>
	<if test="endTime != null">
		and t2.billtime <![CDATA[<]]> #{endTime, jdbcType=BIGINT}
	</if>
  </select>
  <select id="appNoticeDetail" parameterType="com.tianrui.api.req.android.NoticeListParam" resultType="com.tianrui.api.resp.android.NoticeListVo">
  	SELECT
		t1.id,
		t2.`code` AS billCode,
		t1.`code`,
		FROM_UNIXTIME(
			t2.billtime / 1000,
			'%Y-%m-%d'
		) AS billTime,
		t1.vehicleno AS vehicle,
		t3.materielname AS material,
		t1.drivername AS driver,
		CASE
		WHEN t1.source = 0 THEN
			'业务平台'
		WHEN t1.source = 2 THEN
			'客商APP'
		ELSE
			''
		END AS source,
		 t4.grossweight AS grossWeight,
		 t4.tareweight AS tareWeight,
		 t4.netweight AS netWeight,
		 FROM_UNIXTIME(
			t4.lighttime / 1000,
			'%Y-%m-%d %H:%i:%s'
		) AS lightTime,
		 FROM_UNIXTIME(
			t4.weighttime / 1000,
			'%Y-%m-%d %H:%i:%s'
		) AS weightTime,
		 CASE
		WHEN t1.auditstatus = 0 THEN
			0
		WHEN t1.auditstatus = 1
		AND t1.`status` = 0 THEN
			1
		WHEN t1.auditstatus = 1
		AND t1.`status` IN (1, 2, 4, 6, 7) THEN
			2
		WHEN t1.auditstatus = 1
		AND t1.`status` = 5 THEN
			3
		ELSE
			''
		END AS type,
		t4.`code` AS pnCode,
		t3.unit,
		t1.takeamount number,
		t3.margin,
		IF (COUNT(t5.notice_id) = 1, 1, 2) AS noticeType,
		FROM_UNIXTIME(
			t1.sendTime / 1000,
			'%Y-%m-%d %H:%i:%s'
		) AS signTime
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_sales_db_application_detail t3 ON t1.billdetailid = t3.id
	LEFT JOIN tr_pound_db_note t4 ON t1.id = t4.noticeid
	LEFT JOIN tr_sales_application_arrive t5 ON t1.id = t5.notice_id
	WHERE
		t1.state = 1
	AND t1.`status` != 3
	AND t1.id = #{id, jdbcType=VARCHAR}
	GROUP BY t5.notice_id
  </select>
  <select id="appMyVehicleList" parameterType="com.tianrui.api.req.android.MyVehicleListParam" resultType="com.tianrui.api.resp.android.MyVehicleListVo">
  	SELECT
		t1.vehicleno AS vehicle,
		t3.telephone,
		t3.`name` AS driver,
		CASE
		WHEN t1.`status` = 0 THEN
			'未入厂'
		WHEN t1.`status` = 1 THEN
			'一次过磅'
		WHEN t1.`status` = 2 THEN
			'二次过磅'
		WHEN t1.`status` = 4 THEN
			'发卡'
		WHEN t1.`status` = 5
		AND t1.forceOutFactory = 0 THEN
			'出厂'
		WHEN t1.`status` = 5
		AND t1.forceOutFactory = 1 THEN
			'强制出厂'
		WHEN t1.`status` = 6 THEN
			'入厂'
		WHEN t1.`status` = 7 THEN
			'装车'
		ELSE
			''
		END AS `status`
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_driver_db_manage t3 ON t1.driverid = t3.id
	WHERE
		t1.state = 1
	AND t1.`status` != 3
	AND t2.customerid = #{ncId, jdbcType=VARCHAR}
	AND t2.orgid = #{salesOrg, jdbcType=VARCHAR}
	<choose>
		<when test="type == 0">
			and t1.`status` = 0
		</when>
		<when test="type == 1">
			and t1.`status` in (1,2,4,6,7)
		</when>
		<otherwise></otherwise>
	</choose>
	ORDER BY t1.createtime DESC
	<if test="start != null and start >= 0">
        <if test="limit != null">
            limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
        </if>
    </if>
  </select>
  <select id="appMyVehicleListCount" parameterType="com.tianrui.api.req.android.MyVehicleListParam" resultType="java.lang.Long">
  	SELECT
		count(0)
	FROM
		tr_sales_db_arrive t1
	LEFT JOIN tr_sales_db_application t2 ON t1.billid = t2.id
	LEFT JOIN tr_driver_db_manage t3 ON t1.driverid = t3.id
	WHERE
		t1.state = 1
	AND t1.`status` != 3
	AND t2.customerid = #{ncId, jdbcType=VARCHAR}
	AND t2.orgid = #{salesOrg, jdbcType=VARCHAR}
	<choose>
		<when test="type == 0">
			and t1.`status` = 0
		</when>
		<when test="type == 1">
			and t1.`status` in (1,2,4,6,7)
		</when>
		<otherwise></otherwise>
	</choose>
  </select>
</mapper>