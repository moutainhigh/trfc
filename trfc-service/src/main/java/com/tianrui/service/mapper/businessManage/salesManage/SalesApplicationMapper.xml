<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianrui.service.mapper.businessManage.salesManage.SalesApplicationMapper" >
  <resultMap id="BaseResultMap" type="com.tianrui.service.bean.businessManage.salesManage.SalesApplication" >
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="source" property="source" jdbcType="VARCHAR" />
    <result column="billtypeid" property="billtypeid" jdbcType="VARCHAR" />
    <result column="billtypename" property="billtypename" jdbcType="VARCHAR" />
    <result column="customerid" property="customerid" jdbcType="VARCHAR" />
    <result column="customername" property="customername" jdbcType="VARCHAR" />
    <result column="channelcode" property="channelcode" jdbcType="VARCHAR" />
    <result column="salesmanid" property="salesmanid" jdbcType="VARCHAR" />
    <result column="salesmanname" property="salesmanname" jdbcType="VARCHAR" />
    <result column="billtime" property="billtime" jdbcType="BIGINT" />
    <result column="orgid" property="orgid" jdbcType="VARCHAR" />
    <result column="orgname" property="orgname" jdbcType="VARCHAR" />
    <result column="transportcompanyid" property="transportcompanyid" jdbcType="VARCHAR" />
    <result column="transportcompanyname" property="transportcompanyname" jdbcType="VARCHAR" />
    <result column="departmentid" property="departmentid" jdbcType="VARCHAR" />
    <result column="departmentname" property="departmentname" jdbcType="VARCHAR" />
    <result column="auditid" property="auditid" jdbcType="VARCHAR" />
    <result column="auditname" property="auditname" jdbcType="VARCHAR" />
    <result column="audittime" property="audittime" jdbcType="BIGINT" />
    <result column="state" property="state" jdbcType="VARCHAR" />
    <result column="makerid" property="makerid" jdbcType="VARCHAR" />
    <result column="makebillname" property="makebillname" jdbcType="VARCHAR" />
    <result column="makebilltime" property="makebilltime" jdbcType="BIGINT" />
    <result column="remarks" property="remarks" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="createtime" property="createtime" jdbcType="BIGINT" />
    <result column="modifier" property="modifier" jdbcType="VARCHAR" />
    <result column="modifytime" property="modifytime" jdbcType="BIGINT" />
    <result column="utc" property="utc" jdbcType="BIGINT" />
    <result column="vehicle_id" property="vehicleId" jdbcType="VARCHAR" />
    <result column="vehicle_no" property="vehicleNo" jdbcType="VARCHAR" />
    <result column="RFID" property="rfid" jdbcType="VARCHAR" />
    <result column="driver_id" property="driverId" jdbcType="VARCHAR" />
    <result column="driver_name" property="driverName" jdbcType="VARCHAR" />
    <result column="bill_source" property="billSource" jdbcType="BIT" />
    <result column="nc_id" property="ncId" jdbcType="VARCHAR" />
    <result column="valid_status" property="validStatus" jdbcType="VARCHAR" />
    <result column="valid_error" property="validError" jdbcType="VARCHAR" />
    <result column="ncStatus" property="ncStatus" jdbcType="VARCHAR" />
    <result column="pushStatus" property="pushStatus" jdbcType="VARCHAR" />
    <result column="noticeMark" property="noticeMark" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, code, status, source, billtypeid, billtypename, customerid, customername, channelcode, 
    salesmanid, salesmanname, billtime, orgid, orgname, transportcompanyid, transportcompanyname, 
    departmentid, departmentname, auditid, auditname, audittime, state, makerid, makebillname, 
    makebilltime, remarks, creator, createtime, modifier, modifytime, utc, vehicle_id, 
    vehicle_no, RFID, driver_id, driver_name, bill_source, nc_id, valid_status, valid_error, 
    ncStatus, pushStatus, noticeMark
  </sql>
  <sql id="Base_Column_List_S1" >
    s1.id, s1.code, s1.status, s1.source, s1.billtypeid, s1.billtypename, s1.customerid, s1.customername, s1.channelcode, 
    s1.salesmanid, s1.salesmanname, s1.billtime, s1.orgid, s1.orgname, s1.transportcompanyid, s1.transportcompanyname, 
    s1.departmentid, s1.departmentname, s1.auditid, s1.auditname, s1.audittime, s1.state, s1.makerid, s1.makebillname, 
    s1.makebilltime, s1.remarks, s1.creator, s1.createtime, s1.modifier, s1.modifytime, s1.utc, s1.vehicle_id, 
    s1.vehicle_no, s1.RFID, s1.driver_id, s1.driver_name, s1.bill_source, s1.nc_id, s1.valid_status, s1.valid_error,
    s1.ncStatus, s1.pushStatus, s1.noticeMark
  </sql>
  <sql id="Base_Column_List_S1_S2" >
    s1.id, s1.code, s1.status, s1.source, s1.billtypeid, s1.billtypename, s1.customerid, s1.customername, s1.channelcode, 
    s1.salesmanid, s1.salesmanname, s1.billtime, s1.orgid, s1.orgname, s1.transportcompanyid, s1.transportcompanyname, 
    s1.departmentid, s1.departmentname, s1.auditid, s1.auditname, s1.audittime, s1.state, s1.makerid, s1.makebillname, 
    s1.makebilltime, s1.remarks, s1.creator, s1.createtime, s1.modifier, s1.modifytime, s1.utc, s2.id as detailid, s2.materielid, s2. materielname,
    s2.salessum, s2.unit, s2.margin, s2.storagequantity, s2.unstoragequantity, s2.pretendingtake, s2.taxprice
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_sales_db_application
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete from tr_sales_db_application
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesApplication" >
    insert into tr_sales_db_application (id, code, status, 
      source, billtypeid, billtypename, 
      customerid, customername, channelcode, 
      salesmanid, salesmanname, billtime, 
      orgid, orgname, transportcompanyid, 
      transportcompanyname, departmentid, departmentname, 
      auditid, auditname, audittime, 
      state, makerid, makebillname, makebilltime, 
      remarks, creator, createtime, 
      modifier, modifytime, utc, 
      vehicle_id, vehicle_no, RFID, 
      driver_id, driver_name, bill_source, nc_id, 
      valid_status, valid_error, ncStatus, pushStatus,
      noticeMark
      )
    values (#{id,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, 
      #{source,jdbcType=VARCHAR}, #{billtypeid,jdbcType=VARCHAR}, #{billtypename,jdbcType=VARCHAR}, 
      #{customerid,jdbcType=VARCHAR}, #{customername,jdbcType=VARCHAR}, #{channelcode,jdbcType=VARCHAR}, 
      #{salesmanid,jdbcType=VARCHAR}, #{salesmanname,jdbcType=VARCHAR}, #{billtime,jdbcType=BIGINT}, 
      #{orgid,jdbcType=VARCHAR}, #{orgname,jdbcType=VARCHAR}, #{transportcompanyid,jdbcType=VARCHAR}, 
      #{transportcompanyname,jdbcType=VARCHAR}, #{departmentid,jdbcType=VARCHAR}, #{departmentname,jdbcType=VARCHAR}, 
      #{auditid,jdbcType=VARCHAR}, #{auditname,jdbcType=VARCHAR}, #{audittime,jdbcType=BIGINT}, 
      #{state,jdbcType=VARCHAR}, #{makerid,jdbcType=VARCHAR}, #{makebillname,jdbcType=VARCHAR}, #{makebilltime,jdbcType=BIGINT}, 
      #{remarks,jdbcType=VARCHAR}, #{creator,jdbcType=VARCHAR}, #{createtime,jdbcType=BIGINT}, 
      #{modifier,jdbcType=VARCHAR}, #{modifytime,jdbcType=BIGINT}, #{utc,jdbcType=BIGINT},
      #{vehicleId,jdbcType=VARCHAR}, #{vehicleNo,jdbcType=VARCHAR}, #{rfid,jdbcType=VARCHAR},
      #{driverId,jdbcType=VARCHAR}, #{driverName,jdbcType=VARCHAR}, #{billSource,jdbcType=BIT}, 
      #{ncId,jdbcType=VARCHAR}, #{validStatus,jdbcType=VARCHAR}, #{validError,jdbcType=VARCHAR},
      #{ncStatus,jdbcType=VARCHAR}, #{pushStatus,jdbcType=VARCHAR}, #{noticeMark,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesApplication" >
    insert into tr_sales_db_application
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="source != null" >
        source,
      </if>
      <if test="billtypeid != null" >
        billtypeid,
      </if>
      <if test="billtypename != null" >
        billtypename,
      </if>
      <if test="customerid != null" >
        customerid,
      </if>
      <if test="customername != null" >
        customername,
      </if>
      <if test="channelcode != null" >
        channelcode,
      </if>
      <if test="salesmanid != null" >
        salesmanid,
      </if>
      <if test="salesmanname != null" >
        salesmanname,
      </if>
      <if test="billtime != null" >
        billtime,
      </if>
      <if test="orgid != null" >
        orgid,
      </if>
      <if test="orgname != null" >
        orgname,
      </if>
      <if test="transportcompanyid != null" >
        transportcompanyid,
      </if>
      <if test="transportcompanyname != null" >
        transportcompanyname,
      </if>
      <if test="departmentid != null" >
        departmentid,
      </if>
      <if test="departmentname != null" >
        departmentname,
      </if>
      <if test="auditid != null" >
        auditid,
      </if>
      <if test="auditname != null" >
        auditname,
      </if>
      <if test="audittime != null" >
        audittime,
      </if>
      <if test="state != null" >
        state,
      </if>
      <if test="makerid != null" >
        makerid,
      </if>
      <if test="makebillname != null" >
        makebillname,
      </if>
      <if test="makebilltime != null" >
        makebilltime,
      </if>
      <if test="remarks != null" >
        remarks,
      </if>
      <if test="creator != null" >
        creator,
      </if>
      <if test="createtime != null" >
        createtime,
      </if>
      <if test="modifier != null" >
        modifier,
      </if>
      <if test="modifytime != null" >
        modifytime,
      </if>
      <if test="utc != null" >
        utc,
      </if>
      <if test="vehicleId != null" >
        vehicle_id,
      </if>
      <if test="vehicleNo != null" >
        vehicle_no,
      </if>
      <if test="rfid != null" >
        RFID,
      </if>
      <if test="driverId != null" >
        driver_id,
      </if>
      <if test="driverName != null" >
        driver_name,
      </if>
      <if test="billSource != null" >
        bill_source,
      </if>
      <if test="ncId != null" >
        nc_id,
      </if>
      <if test="validStatus != null" >
        valid_status,
      </if>
      <if test="validError != null" >
        valid_error,
      </if>
      <if test="ncStatus != null" >
        ncStatus,
      </if>
      <if test="pushStatus != null" >
        pushStatus,
      </if>
      <if test="noticeMark != null" >
        noticeMark,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        #{source,jdbcType=VARCHAR},
      </if>
      <if test="billtypeid != null" >
        #{billtypeid,jdbcType=VARCHAR},
      </if>
      <if test="billtypename != null" >
        #{billtypename,jdbcType=VARCHAR},
      </if>
      <if test="customerid != null" >
        #{customerid,jdbcType=VARCHAR},
      </if>
      <if test="customername != null" >
        #{customername,jdbcType=VARCHAR},
      </if>
      <if test="channelcode != null" >
        #{channelcode,jdbcType=VARCHAR},
      </if>
      <if test="salesmanid != null" >
        #{salesmanid,jdbcType=VARCHAR},
      </if>
      <if test="salesmanname != null" >
        #{salesmanname,jdbcType=VARCHAR},
      </if>
      <if test="billtime != null" >
        #{billtime,jdbcType=BIGINT},
      </if>
      <if test="orgid != null" >
        #{orgid,jdbcType=VARCHAR},
      </if>
      <if test="orgname != null" >
        #{orgname,jdbcType=VARCHAR},
      </if>
      <if test="transportcompanyid != null" >
        #{transportcompanyid,jdbcType=VARCHAR},
      </if>
      <if test="transportcompanyname != null" >
        #{transportcompanyname,jdbcType=VARCHAR},
      </if>
      <if test="departmentid != null" >
        #{departmentid,jdbcType=VARCHAR},
      </if>
      <if test="departmentname != null" >
        #{departmentname,jdbcType=VARCHAR},
      </if>
      <if test="auditid != null" >
        #{auditid,jdbcType=VARCHAR},
      </if>
      <if test="auditname != null" >
        #{auditname,jdbcType=VARCHAR},
      </if>
      <if test="audittime != null" >
        #{audittime,jdbcType=BIGINT},
      </if>
      <if test="state != null" >
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="makerid != null" >
        #{makerid,jdbcType=VARCHAR},
      </if>
      <if test="makebillname != null" >
        #{makebillname,jdbcType=VARCHAR},
      </if>
      <if test="makebilltime != null" >
        #{makebilltime,jdbcType=BIGINT},
      </if>
      <if test="remarks != null" >
        #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=BIGINT},
      </if>
      <if test="modifier != null" >
        #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="modifytime != null" >
        #{modifytime,jdbcType=BIGINT},
      </if>
      <if test="utc != null" >
        #{utc,jdbcType=BIGINT},
      </if>
      <if test="vehicleId != null" >
        #{vehicleId,jdbcType=VARCHAR},
      </if>
      <if test="vehicleNo != null" >
        #{vehicleNo,jdbcType=VARCHAR}, 
      </if>
      <if test="rfid != null" >
        #{rfid,jdbcType=VARCHAR},
      </if>
      <if test="driverId != null" >
        #{driverId,jdbcType=VARCHAR},
      </if>
      <if test="driverName != null" >
        #{driverName,jdbcType=VARCHAR},
      </if>
      <if test="billSource != null" >
        #{billSource,jdbcType=BIT},
      </if>
      <if test="ncId != null" >
        #{ncId,jdbcType=VARCHAR},
      </if>
      <if test="validStatus != null" >
        #{validStatus,jdbcType=VARCHAR},
      </if>
      <if test="validError != null" >
        #{validError,jdbcType=VARCHAR},
      </if>
      <if test="ncStatus != null" >
        #{ncStatus,jdbcType=VARCHAR},
      </if>
      <if test="pushStatus != null" >
        #{pushStatus,jdbcType=VARCHAR},
      </if>
      <if test="noticeMark != null" >
        #{noticeMark,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesApplication" >
    update tr_sales_db_application
    <set >
      <if test="code != null" >
        code = #{code,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        source = #{source,jdbcType=VARCHAR},
      </if>
      <if test="billtypeid != null" >
        billtypeid = #{billtypeid,jdbcType=VARCHAR},
      </if>
      <if test="billtypename != null" >
        billtypename = #{billtypename,jdbcType=VARCHAR},
      </if>
      <if test="customerid != null" >
        customerid = #{customerid,jdbcType=VARCHAR},
      </if>
      <if test="customername != null" >
        customername = #{customername,jdbcType=VARCHAR},
      </if>
      <if test="channelcode != null" >
        channelcode = #{channelcode,jdbcType=VARCHAR},
      </if>
      <if test="salesmanid != null" >
        salesmanid = #{salesmanid,jdbcType=VARCHAR},
      </if>
      <if test="salesmanname != null" >
        salesmanname = #{salesmanname,jdbcType=VARCHAR},
      </if>
      <if test="billtime != null" >
        billtime = #{billtime,jdbcType=BIGINT},
      </if>
      <if test="orgid != null" >
        orgid = #{orgid,jdbcType=VARCHAR},
      </if>
      <if test="orgname != null" >
        orgname = #{orgname,jdbcType=VARCHAR},
      </if>
      <if test="transportcompanyid != null" >
        transportcompanyid = #{transportcompanyid,jdbcType=VARCHAR},
      </if>
      <if test="transportcompanyname != null" >
        transportcompanyname = #{transportcompanyname,jdbcType=VARCHAR},
      </if>
      <if test="departmentid != null" >
        departmentid = #{departmentid,jdbcType=VARCHAR},
      </if>
      <if test="departmentname != null" >
        departmentname = #{departmentname,jdbcType=VARCHAR},
      </if>
      <if test="auditid != null" >
        auditid = #{auditid,jdbcType=VARCHAR},
      </if>
      <if test="auditname != null" >
        auditname = #{auditname,jdbcType=VARCHAR},
      </if>
      <if test="audittime != null" >
        audittime = #{audittime,jdbcType=BIGINT},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=VARCHAR},
      </if>
      <if test="makerid != null" >
        makerid = #{makerid,jdbcType=VARCHAR},
      </if>
      <if test="makebillname != null" >
        makebillname = #{makebillname,jdbcType=VARCHAR},
      </if>
      <if test="makebilltime != null" >
        makebilltime = #{makebilltime,jdbcType=BIGINT},
      </if>
      <if test="remarks != null" >
        remarks = #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        creator = #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        createtime = #{createtime,jdbcType=BIGINT},
      </if>
      <if test="modifier != null" >
        modifier = #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="modifytime != null" >
        modifytime = #{modifytime,jdbcType=BIGINT},
      </if>
      <if test="utc != null" >
        utc = #{utc,jdbcType=BIGINT},
      </if>
      <if test="vehicleId != null" >
        vehicle_id = #{vehicleId,jdbcType=VARCHAR},
      </if>
      <if test="vehicleNo != null" >
        vehicle_no = #{vehicleNo,jdbcType=VARCHAR}, 
      </if>
      <if test="rfid != null" >
        RFID = #{rfid,jdbcType=VARCHAR},
      </if>
      <if test="driverId != null" >
        driver_id = #{driverId,jdbcType=VARCHAR},
      </if>
      <if test="driverName != null" >
        driver_name = #{driverName,jdbcType=VARCHAR},
      </if>
      <if test="billSource != null" >
        bill_source = #{billSource,jdbcType=BIT},
      </if>
      <if test="ncId != null" >
        nc_id = #{ncId,jdbcType=VARCHAR},
      </if>
      <if test="validStatus != null" >
        valid_status = #{validStatus,jdbcType=VARCHAR},
      </if>
      <if test="validError != null" >
        valid_error = #{validError,jdbcType=VARCHAR},
      </if>
      <if test="ncStatus != null" >
        ncStatus = #{ncStatus,jdbcType=VARCHAR},
      </if>
      <if test="pushStatus != null" >
        pushStatus = #{pushStatus,jdbcType=VARCHAR},
      </if>
      <if test="noticeMark != null" >
        noticeMark = #{noticeMark,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesApplication" >
    update tr_sales_db_application
    set code = #{code,jdbcType=VARCHAR},
      status = #{status,jdbcType=VARCHAR},
      source = #{source,jdbcType=VARCHAR},
      billtypeid = #{billtypeid,jdbcType=VARCHAR},
      billtypename = #{billtypename,jdbcType=VARCHAR},
      customerid = #{customerid,jdbcType=VARCHAR},
      customername = #{customername,jdbcType=VARCHAR},
      channelcode = #{channelcode,jdbcType=VARCHAR},
      salesmanid = #{salesmanid,jdbcType=VARCHAR},
      salesmanname = #{salesmanname,jdbcType=VARCHAR},
      billtime = #{billtime,jdbcType=BIGINT},
      orgid = #{orgid,jdbcType=VARCHAR},
      orgname = #{orgname,jdbcType=VARCHAR},
      transportcompanyid = #{transportcompanyid,jdbcType=VARCHAR},
      transportcompanyname = #{transportcompanyname,jdbcType=VARCHAR},
      departmentid = #{departmentid,jdbcType=VARCHAR},
      departmentname = #{departmentname,jdbcType=VARCHAR},
      auditid = #{auditid,jdbcType=VARCHAR},
      auditname = #{auditname,jdbcType=VARCHAR},
      audittime = #{audittime,jdbcType=BIGINT},
      state = #{state,jdbcType=VARCHAR},
      makerid = #{makerid,jdbcType=VARCHAR},
      makebillname = #{makebillname,jdbcType=VARCHAR},
      makebilltime = #{makebilltime,jdbcType=BIGINT},
      remarks = #{remarks,jdbcType=VARCHAR},
      creator = #{creator,jdbcType=VARCHAR},
      createtime = #{createtime,jdbcType=BIGINT},
      modifier = #{modifier,jdbcType=VARCHAR},
      modifytime = #{modifytime,jdbcType=BIGINT},
      utc = #{utc,jdbcType=BIGINT},
      vehicle_id = #{vehicleId,jdbcType=VARCHAR},
      vehicle_no = #{vehicleNo,jdbcType=VARCHAR}, 
      RFID = #{rfid,jdbcType=VARCHAR},
      driver_id = #{driverId,jdbcType=VARCHAR},
      driver_name = #{driverName,jdbcType=VARCHAR},
      bill_source = #{billSource,jdbcType=BIT},
      nc_id = #{ncId,jdbcType=VARCHAR},
      valid_status = #{validStatus,jdbcType=VARCHAR},
      valid_error = #{validError,jdbcType=VARCHAR},
      ncStatus = #{ncStatus,jdbcType=VARCHAR},
      pushStatus = #{pushStatus,jdbcType=VARCHAR},
      noticeMark = #{noticeMark,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <select id="selectSelective" parameterType="com.tianrui.service.bean.businessManage.salesManage.SalesApplication" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_sales_db_application
  	<where>
  	  <if test="id != null and id != ''" >
        and id = #{id,jdbcType=VARCHAR}
      </if>
  	  <if test="code != null and code !=''" >
        and code = #{code,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status !=''" >
        and status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="source != null and source !=''" >
        and source = #{source,jdbcType=VARCHAR}
      </if>
      <if test="billtypeid != null and billtypeid !=''" >
        and billtypeid = #{billtypeid,jdbcType=VARCHAR}
      </if>
      <if test="billtypename != null and billtypename !=''" >
        and billtypename = #{billtypename,jdbcType=VARCHAR}
      </if>
      <if test="customerid != null and customerid !=''" >
        and customerid = #{customerid,jdbcType=VARCHAR}
      </if>
      <if test="customername != null and customername !=''" >
        and customername = #{customername,jdbcType=VARCHAR}
      </if>
      <if test="channelcode != null and channelcode !=''" >
        and channelcode = #{channelcode,jdbcType=VARCHAR}
      </if>
      <if test="salesmanid != null and salesmanid !=''" >
        and salesmanid = #{salesmanid,jdbcType=VARCHAR}
      </if>
      <if test="salesmanname != null and salesmanname !=''" >
        and salesmanname = #{salesmanname,jdbcType=VARCHAR}
      </if>
      <if test="billtime != null and billtime !=''" >
        and billtime = #{billtime,jdbcType=BIGINT}
      </if>
      <if test="orgid != null and orgid !=''" >
        and orgid = #{orgid,jdbcType=VARCHAR}
      </if>
      <if test="orgname != null and orgname !=''" >
        and orgname = #{orgname,jdbcType=VARCHAR}
      </if>
      <if test="transportcompanyid != null and transportcompanyid !=''" >
        and transportcompanyid = #{transportcompanyid,jdbcType=VARCHAR}
      </if>
      <if test="transportcompanyname != null and transportcompanyname !=''" >
        and transportcompanyname = #{transportcompanyname,jdbcType=VARCHAR}
      </if>
      <if test="departmentid != null and departmentid !=''" >
        and departmentid = #{departmentid,jdbcType=VARCHAR}
      </if>
      <if test="departmentname != null and departmentname !=''" >
        and departmentname = #{departmentname,jdbcType=VARCHAR}
      </if>
      <if test="auditid != null and auditid !=''" >
        and auditid = #{auditid,jdbcType=VARCHAR}
      </if>
      <if test="auditname != null and auditname !=''" >
        and auditname = #{auditname,jdbcType=VARCHAR}
      </if>
      <if test="audittime != null and audittime !=''" >
        and audittime = #{audittime,jdbcType=BIGINT}
      </if>
      <if test="state != null and state !=''" >
        and state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="makerid != null and makerid !=''" >
        and makerid = #{makerid,jdbcType=VARCHAR}
      </if>
      <if test="makebillname != null and makebillname !=''" >
        and makebillname = #{makebillname,jdbcType=VARCHAR}
      </if>
      <if test="makebilltime != null and makebilltime !=''" >
        and makebilltime = #{makebilltime,jdbcType=BIGINT}
      </if>
      <if test="remarks != null and remarks !=''" >
        and remarks = #{remarks,jdbcType=VARCHAR}
      </if>
      <if test="creator != null and creator !=''" >
        and creator = #{creator,jdbcType=VARCHAR}
      </if>
      <if test="createtime != null and createtime !=''" >
        and createtime = #{createtime,jdbcType=BIGINT}
      </if>
      <if test="modifier != null and modifier !=''" >
        and modifier = #{modifier,jdbcType=VARCHAR}
      </if>
      <if test="modifytime != null and modifytime !=''" >
        and modifytime = #{modifytime,jdbcType=BIGINT}
      </if>
      <if test="utc != null and utc !=''" >
        and utc = #{utc,jdbcType=BIGINT}
      </if>
      <if test="vehicleId != null and vehicleId !=''" >
        and vehicle_id = #{vehicleId,jdbcType=VARCHAR}
      </if>
      <if test="vehicleNo != null and vehicleNo !=''" >
        and vehicle_no = #{vehicleNo,jdbcType=VARCHAR} 
      </if>
      <if test="rfid != null and rfid !=''" >
        and RFID = #{rfid,jdbcType=VARCHAR}
      </if>
      <if test="driverId != null and driverId !=''" >
        and driver_id = #{driverId,jdbcType=VARCHAR}
      </if>
      <if test="driverName != null and driverName !=''" >
        and driver_name = #{driverName,jdbcType=VARCHAR}
      </if>
      <if test="billSource != null and billSource !=''" >
        and bill_source = #{billSource,jdbcType=BIT}
      </if>
      <if test="ncId != null and ncId !=''" >
        and nc_id = #{ncId,jdbcType=VARCHAR}
      </if>
      <if test="validStatus != null and validStatus !=''" >
        and valid_status = #{validStatus,jdbcType=VARCHAR}
      </if>
      <if test="validError != null and validError !=''" >
        and valid_error = #{validError,jdbcType=VARCHAR}
      </if>
      <if test="ncStatus != null and ncStatus !=''" >
        and ncStatus = #{ncStatus,jdbcType=VARCHAR}
      </if>
      <if test="pushStatus != null and pushStatus !=''" >
        and pushStatus = #{pushStatus,jdbcType=VARCHAR}
      </if>
      <if test="noticeMark != null and noticeMark !=''" >
        and noticeMark = #{noticeMark,jdbcType=VARCHAR}
      </if>
  	</where>
  </select>
  <select id="findSalesApplicationPage" parameterType="com.tianrui.api.req.businessManage.salesManage.SalesApplicationQuery" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_sales_db_application
  	<where>
  		<if test="state != null and state != ''">
  			and state = #{state,jdbcType=VARCHAR}
  		</if>
  		<if test="customerid != null and customerid != ''">
  			and customerid = #{customerid,jdbcType=VARCHAR}
  		</if>
  		<if test="source != null and source != ''">
  			and source = #{source,jdbcType=VARCHAR}
  		</if>
  		<if test="code != null and code != ''">
  			and code = #{code,jdbcType=VARCHAR}
  		</if>
  		<if test="starttime != null and starttime != ''">
  			and createtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
  		</if>
  		<if test="endtime != null and endtime != ''">
  			and createtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
  		</if>
  	</where>
  	order by createtime desc
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="findSalesApplicationPageCount" parameterType="com.tianrui.api.req.businessManage.salesManage.SalesApplicationQuery" resultType="java.lang.Long" >
  	select count(0)
  	from tr_sales_db_application
  	<where>
  		<if test="state != null and state != ''">
  			and state = #{state,jdbcType=VARCHAR}
  		</if>
  		<if test="customerid != null and customerid != ''">
  			and customerid = #{customerid,jdbcType=VARCHAR}
  		</if>
  		<if test="source != null and source != ''">
  			and source = #{source,jdbcType=VARCHAR}
  		</if>
  		<if test="code != null and code != ''">
  			and code = #{code,jdbcType=VARCHAR}
  		</if>
  		<if test="starttime != null and starttime != ''">
  			and createtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
  		</if>
  		<if test="endtime != null and endtime != ''">
  			and createtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
  		</if>
  	</where>
  </select>
  <select id="findPageGroupMateriel" parameterType="com.tianrui.api.req.businessManage.salesManage.SalesApplicationQuery" resultType="com.tianrui.api.resp.businessManage.salesManage.SalesApplicationJoinDetailResp">
  	select
  	<include refid="Base_Column_List_S1_S2" />, s3.packagetype
  	from tr_sales_db_application s1 
  	left join tr_sales_db_application_detail s2 on s1.id = s2.salesid
  	left join tr_materiel_db_manage s3 on s2.materielid = s3.id
  	where s1.state = 1 and s1.billtypeid = 1 and s1.valid_status = 0
  		and ((s1.ncStatus = 2 and s2.ncStatus = 2) or s1.status = 1) 
	<if test="id != null and id != ''">
		and s1.id = #{id,jdbcType=VARCHAR}
	</if>
	<if test="detailid != null and detailid != ''">
		and s2.id = #{detailid,jdbcType=VARCHAR}
	</if>
	<if test="state != null and state != ''">
		and s1.state = #{state,jdbcType=VARCHAR}
	</if>
	<if test="customerid != null and customerid != ''">
		and s1.customerid = #{customerid,jdbcType=VARCHAR}
	</if>
	<if test="code != null and code != ''">
		and s1.code = #{code,jdbcType=VARCHAR}
	</if>
	<if test="materielid != null and materielid != ''">
		and s2.materielid = #{materielid,jdbcType=VARCHAR}
	</if>
	<if test="starttime != null and starttime != ''">
		and s1.createtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	</if>
	<if test="endtime != null and endtime != ''">
		and s1.createtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	</if>
  	order by s1.createtime desc
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="findPageGroupMaterielCount" parameterType="com.tianrui.api.resp.businessManage.salesManage.SalesApplicationJoinDetailResp" resultType="java.lang.Long">
  	select count(0)
  	from tr_sales_db_application s1 left join tr_sales_db_application_detail s2 
  	on s1.id = s2.salesid
  	where s1.state = 1 and s1.billtypeid = 1 and s1.valid_status = 0
  		and ((s1.ncStatus = 2 and s2.ncStatus = 2) or s1.status = 1) 
	<if test="state != null and state != ''">
		and s1.state = #{state,jdbcType=VARCHAR}
	</if>
	<if test="customerid != null and customerid != ''">
		and s1.customerid = #{customerid,jdbcType=VARCHAR}
	</if>
	<if test="code != null and code != ''">
		and s1.code = #{code,jdbcType=VARCHAR}
	</if>
	<if test="materielid != null and materielid != ''">
		and s2.materielid = #{materielid,jdbcType=VARCHAR}
	</if>
	<if test="starttime != null and starttime != ''">
		and s1.createtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	</if>
	<if test="endtime != null and endtime != ''">
		and s1.createtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	</if>
  </select>
  <select id="findMaxUtc" resultType="Long"  >
    select 
   		max(utc)
    from tr_sales_db_application
  </select>
  <insert id="insertBatch" parameterType="java.util.List">
	insert into tr_sales_db_application (id, code, status, source, billtypeid, billtypename, customerid, customername, channelcode, 
    salesmanid, salesmanname, billtime, orgid, orgname, transportcompanyid, transportcompanyname, 
    departmentid, departmentname, auditid, auditname, audittime, state, makerid, makebillname, 
    makebilltime, remarks, creator, createtime, modifier, modifytime, utc, vehicle_id, 
    vehicle_no, RFID, driver_id, driver_name, bill_source, nc_id, valid_status, valid_error, 
    ncStatus, pushStatus, noticeMark)
	values
	<foreach collection="list" item="item" index="index" separator=",">
		(#{item.id,jdbcType=VARCHAR}, 
		#{item.code,jdbcType=VARCHAR},
		#{item.status,jdbcType=VARCHAR},
		#{item.source,jdbcType=VARCHAR},
		#{item.billtypeid,jdbcType=VARCHAR},
		#{item.billtypename,jdbcType=VARCHAR},
		#{item.customerid,jdbcType=VARCHAR},
		#{item.customername,jdbcType=VARCHAR},
		#{item.channelcode,jdbcType=VARCHAR},
		#{item.salesmanid,jdbcType=VARCHAR},
		#{item.salesmanname,jdbcType=VARCHAR},
		#{item.billtime,jdbcType=VARCHAR},
		#{item.orgid,jdbcType=VARCHAR},
		#{item.orgname,jdbcType=VARCHAR},
		#{item.transportcompanyid,jdbcType=VARCHAR},
		#{item.transportcompanyname,jdbcType=VARCHAR},
		#{item.departmentid,jdbcType=VARCHAR},
		#{item.departmentname,jdbcType=VARCHAR},
		#{item.auditid,jdbcType=VARCHAR},
		#{item.auditname,jdbcType=VARCHAR},
		#{item.audittime,jdbcType=VARCHAR},
		#{item.state,jdbcType=VARCHAR},
		#{item.makerid,jdbcType=VARCHAR},
		#{item.makebillname,jdbcType=VARCHAR},
		#{item.makebilltime,jdbcType=VARCHAR},
		#{item.remarks,jdbcType=VARCHAR},
		#{item.creator,jdbcType=VARCHAR},
		#{item.createtime,jdbcType=VARCHAR},
		#{item.modifier,jdbcType=VARCHAR},
		#{item.modifytime,jdbcType=VARCHAR},
		#{item.utc,jdbcType=VARCHAR},
		#{item.vehicleId,jdbcType=VARCHAR}, 
		#{item.vehicleNo,jdbcType=VARCHAR}, 
		#{item.rfid,jdbcType=VARCHAR},
      	#{item.driverId,jdbcType=VARCHAR}, 
      	#{item.driverName,jdbcType=VARCHAR}, 
      	#{item.billSource,jdbcType=BIT}, 
     	#{item.ncId,jdbcType=VARCHAR},
     	#{item.validStatus,jdbcType=VARCHAR},
     	#{item.validError,jdbcType=VARCHAR},
     	#{item.ncStatus,jdbcType=VARCHAR},
     	#{item.pushStatus,jdbcType=VARCHAR},
     	#{item.noticeMark,jdbcType=VARCHAR}
		)
	</foreach>
  </insert>
  <select id="selectByIds" parameterType="java.util.List" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_sales_db_application
  	where id in
	<foreach item="item" index="index" collection="list" open="(" separator="," close=")">  
		#{item}  
	</foreach>
  </select>
  <select id="findAppToPageGroupMaterielCount" parameterType="com.tianrui.api.req.businessManage.app.AppOrderReq" resultType="java.lang.Long">
  	select count(0)
  	from tr_sales_db_application s1 left join tr_sales_db_application_detail s2 
  	on s1.id = s2.salesid
  	<where>
  		<if test="state != null and state != ''">
  			and s1.state = #{state,jdbcType=VARCHAR}
  		</if>
		<if test="code != null and code != ''">
			and s1.code = #{code, jdbcType=VARCHAR}
		</if>
		<if test="materielid != null and materielid != ''">
			and s2.materielid = #{materielid, jdbcType=VARCHAR}
		</if>
      	<if test="userId != null and userId != ''">
			and s1.customerid = #{userId,jdbcType=VARCHAR}
	  	</if>
      	<if test="starttime != null and starttime != ''">
			and s1.billtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  	</if>
	  	<if test="endtime != null and endtime != ''">
			and s1.billtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	 	</if>
  	</where>
  </select>
  <select id="findAppToPageGroupMateriel" parameterType="com.tianrui.api.req.businessManage.app.AppOrderReq" resultType="com.tianrui.api.resp.businessManage.app.AppOrderResp">
  	select s1.id, s2.id as detailid, s1.code, s2.materielname as materialName,
  		s1.customername as customerName, s2.salessum as billSum, s2.margin, s1.remarks as remark
  	from tr_sales_db_application s1 
  	left join tr_sales_db_application_detail s2 on s1.id = s2.salesid
  	<where>
  		<if test="state != null and state != ''">
  			and s1.state = #{state,jdbcType=VARCHAR}
  		</if>
		<if test="code != null and code != ''">
			and s1.code = #{code, jdbcType=VARCHAR}
		</if>
		<if test="materielid != null and materielid != ''">
			and s2.materielid = #{materielid, jdbcType=VARCHAR}
		</if>
      	<if test="userId != null and userId != ''">
			and s1.customerid = #{userId,jdbcType=VARCHAR}
	  	</if>
      	<if test="starttime != null and starttime != ''">
			and s1.billtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  	</if>
	  	<if test="endtime != null and endtime != ''">
			and s1.billtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	 	</if>
  	</where>
  	<if test="orderColumn != null and orderColumn != ''">
  		order by ${orderColumn} 
  		<choose>
  			<when test="orderAsc == 'DESC'">
  				DESC
  			</when>
  			<otherwise>
  				ASC
  			</otherwise>
  		</choose>
  	</if>
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="appHomeBill" parameterType="com.tianrui.api.req.android.HomePageParam" resultType="com.tianrui.api.resp.android.HomeBillVo">
  	SELECT
		t1.id,
		t1.`code`,
		t2.id AS detailId,
		t2.materielname AS material,
		FROM_UNIXTIME(
			t1.billtime / 1000,
			"%Y-%m-%d"
		) AS billTime,
		CASE
		WHEN t1.bill_source = 0 THEN
			'NC'
		WHEN t1.bill_source = 1 THEN
			'业务平台'
		WHEN t1.bill_source = 2 THEN
			'客商APP'
		ELSE
			''
		END AS billSource
	FROM
		tr_sales_db_application t1
	LEFT JOIN tr_sales_db_application_detail t2 ON t1.id = t2.salesid
	WHERE
		t1.customerid = #{ncId,jdbcType=VARCHAR}
	AND t1.orgid = #{salesOrg,jdbcType=VARCHAR}
	AND t1.state = 1
	AND t1.`status` = 1
	ORDER BY t1.billtime DESC
  </select>
  <select id="appBillList" parameterType="com.tianrui.api.req.android.BillListParam" resultType="com.tianrui.api.resp.android.BillListVo">
	SELECT
		t1.id, t2.id AS detailId, t1.`code`, t1.billtypeid AS billType,
		FROM_UNIXTIME(
			t1.billtime / 1000,
			"%Y-%m-%d"
		) AS billTime,
		CASE
		WHEN t1.bill_source = 0 THEN
			'NC'
		WHEN t1.bill_source = 1 THEN
			'业务平台'
		WHEN t1.bill_source = 2 THEN
			'客商APP'
		ELSE
			''
		END AS billSource,
		t2.materielname AS material, 
		t2.margin, 
		t2.unit
	FROM
		tr_sales_db_application t1
	LEFT JOIN tr_sales_db_application_detail t2 ON t1.id = t2.salesid
	WHERE t1.state = 1  and t1.valid_status = 0
		and t1.customerid = #{ncId, jdbcType=VARCHAR}
		and t1.orgid = #{salesOrg, jdbcType=VARCHAR}
		<choose>
			<when test="type == 0">
				and t1.ncStatus != 2 and t1.bill_source != 0 and t1.billtypeid = 0
			</when>
			<when test="type == 1">
				and (t1.ncStatus = 2 or (t1.status = 1 and t1.billtypeid = 1)) and t2.margin > 0
			</when>
			<when test="type == 2">
				and (t1.ncStatus = 2 or (t1.status = 1 and t1.billtypeid = 1)) and t2.margin <![CDATA[<=]]> 0
			</when>
			<otherwise></otherwise>
		</choose>
		<if test="billCode != null and billCode != ''">
			and t1.code = #{billCode, jdbcType=VARCHAR}
		</if>
		<if test="billSource != null and billSource != ''">
			and t1.bill_source = #{billSource, jdbcType=VARCHAR}
		</if>
		<if test="startTime != null and startTime != ''">
			and t1.billtime <![CDATA[>=]]> #{startTime, jdbcType=BIGINT}
		</if>
		<if test="endTime != null and endTime != ''">
			and t1.billtime <![CDATA[<]]> #{endTime, jdbcType=BIGINT}
		</if>
		ORDER BY t1.billtime
		<if test="start != null and start >= 0">
	  		<if test="limit != null">
				limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
	  		</if>
	  	</if>
  </select>
  <select id="appBillListCount" parameterType="com.tianrui.api.req.android.BillListParam" resultType="java.lang.Long">
	SELECT
		count(0)
	FROM
		tr_sales_db_application t1
	LEFT JOIN tr_sales_db_application_detail t2 ON t1.id = t2.salesid
	WHERE t1.state = 1 and t1.valid_status = 0
		and t1.customerid = #{ncId, jdbcType=VARCHAR}
		and t1.orgid = #{salesOrg, jdbcType=VARCHAR}
		<choose>
			<when test="type == 0">
				and t1.ncStatus != 2 and t1.bill_source != 0 and t1.billtypeid = 0
			</when>
			<when test="type == 1">
				and (t1.ncStatus = 2 or (t1.status = 1 and t1.billtypeid = 1)) and t2.margin > 0
			</when>
			<when test="type == 2">
				and (t1.ncStatus = 2 or (t1.status = 1 and t1.billtypeid = 1)) and t2.margin <![CDATA[<=]]> 0
			</when>
			<otherwise></otherwise>
		</choose>
		<if test="billCode != null and billCode != ''">
			and t1.code = #{billCode, jdbcType=VARCHAR}
		</if>
		<if test="billSource != null and billSource != ''">
			and t1.bill_source = #{billSource, jdbcType=VARCHAR}
		</if>
		<if test="startTime != null and startTime != ''">
			and t1.billtime <![CDATA[>=]]> #{startTime, jdbcType=BIGINT}
		</if>
		<if test="endTime != null and endTime != ''">
			and t1.billtime <![CDATA[<]]> #{endTime, jdbcType=BIGINT}
		</if>
  </select>
  <select id="appBillDetail" parameterType="com.tianrui.api.req.android.BillListParam" resultType="com.tianrui.api.resp.android.BillListVo">
	SELECT
		t1.id, t2.id AS detailId, t1.`code`, t1.billtypename AS billType,
		FROM_UNIXTIME(
			t1.billtime / 1000,
			"%Y-%m-%d"
		) AS billTime,
		CASE
		WHEN t1.bill_source = 0 THEN
			'NC'
		WHEN t1.bill_source = 1 THEN
			'业务平台'
		WHEN t1.bill_source = 2 THEN
			'客商APP'
		ELSE
			''
		END AS billSource,
		t2.materielname AS material, 
		t2.margin, 
		t2.unit, 
		t2.salessum AS sumNum, 
		t2.storagequantity AS outInNum,
		t2.unstoragequantity AS unOutInNum, 
		t2.pretendingtake AS planNum,
		t2.taxprice AS price,
		CASE
		WHEN t1.ncStatus != 2 THEN 0
		WHEN (t1.status = 1 or t1.ncStatus = 2) and t2.margin > 0 THEN 1
		WHEN (t1.status = 1 or t1.ncStatus = 2) and t2.margin <![CDATA[<=]]> 0 THEN 2
		ELSE ''
		END AS type,
		t1.vehicle_no AS vehicle
	FROM
		tr_sales_db_application t1
	LEFT JOIN tr_sales_db_application_detail t2 ON t1.id = t2.salesid
	WHERE 
		t1.id = #{id, jdbcType=VARCHAR} 
	AND t2.id = #{detailId, jdbcType=VARCHAR}
  </select>
  <select id="appMoreBillList" parameterType="com.tianrui.api.req.android.BillListParam" resultType="com.tianrui.api.resp.android.BillListVo">
	SELECT
	t1.id,
	t2.id AS detailId,
	t1.`code`,
	FROM_UNIXTIME(
		t1.billtime / 1000,
		"%Y-%m-%d"
	) AS billTime,
	CASE
	WHEN t1.bill_source = 0 THEN
		'NC'
	WHEN t1.bill_source = 1 THEN
		'业务平台'
	WHEN t1.bill_source = 2 THEN
		'客商APP'
	ELSE
		''
	END AS billSource,
	 t2.materielname AS material,
	 t2.margin,
	 t2.unit,
	 t1.billtypeid AS billType
	FROM
		tr_sales_db_application t1
	LEFT JOIN tr_sales_db_application_detail t2 ON t1.id = t2.salesid
	WHERE
		t1.state = 1
	AND t1.billtypeid = 1
	AND t1.valid_status = 0
	AND ((t1.ncStatus = 2 and t2.ncStatus = 2) or t1.`status` = 1)
	AND t2.margin > 0
	AND t1.orgid = #{salesOrg, jdbcType=VARCHAR} 
	AND t1.customerid = #{ncId, jdbcType=VARCHAR} 
	AND t2.materielid = #{material, jdbcType=VARCHAR} 
  </select>
  <select id="listOneBillOneCarNotNotice" resultMap="BaseResultMap">
	SELECT
		<include refid="Base_Column_List"/>
	FROM
		tr_sales_db_application
	WHERE
		`status` = 1
	AND billtypeid = 0
	AND valid_status = 0
	AND ncStatus = 2
	AND vehicle_no IS NOT NULL
	AND (
		noticeMark IS NULL
		OR noticeMark = 0
	)
  </select>
</mapper>