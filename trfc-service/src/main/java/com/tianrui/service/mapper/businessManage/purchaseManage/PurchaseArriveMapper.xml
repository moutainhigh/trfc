<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianrui.service.mapper.businessManage.purchaseManage.PurchaseArriveMapper" >
  <resultMap id="BaseResultMap" type="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive" >
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="auditstatus" property="auditstatus" jdbcType="VARCHAR" />
    <result column="source" property="source" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="vehicleid" property="vehicleid" jdbcType="VARCHAR" />
    <result column="vehicleno" property="vehicleno" jdbcType="VARCHAR" />
    <result column="vehiclerfid" property="vehiclerfid" jdbcType="VARCHAR" />
    <result column="driverid" property="driverid" jdbcType="VARCHAR" />
    <result column="drivername" property="drivername" jdbcType="VARCHAR" />
    <result column="driveridentityno" property="driveridentityno" jdbcType="VARCHAR" />
    <result column="billid" property="billid" jdbcType="VARCHAR" />
    <result column="billcode" property="billcode" jdbcType="VARCHAR" />
    <result column="billdetailid" property="billdetailid" jdbcType="VARCHAR" />
    <result column="poundnoteid" property="poundnoteid" jdbcType="VARCHAR" />
    <result column="poundnotecode" property="poundnotecode" jdbcType="VARCHAR" />
    <result column="abnormalperson" property="abnormalperson" jdbcType="VARCHAR" />
    <result column="abnormalpersonname" property="abnormalpersonname" jdbcType="VARCHAR" />
    <result column="abnormaltime" property="abnormaltime" jdbcType="BIGINT" />
    <result column="arrivalamount" property="arrivalamount" jdbcType="DOUBLE" />
    <result column="signamount" property="signamount" jdbcType="DOUBLE" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="makerid" property="makerid" jdbcType="VARCHAR" />
    <result column="makebillname" property="makebillname" jdbcType="VARCHAR" />
    <result column="makebilltime" property="makebilltime" jdbcType="BIGINT" />
    <result column="icardid" property="icardid" jdbcType="VARCHAR" />
    <result column="state" property="state" jdbcType="VARCHAR" />
    <result column="creator" property="creator" jdbcType="VARCHAR" />
    <result column="createtime" property="createtime" jdbcType="BIGINT" />
    <result column="modifier" property="modifier" jdbcType="VARCHAR" />
    <result column="modifytime" property="modifytime" jdbcType="BIGINT" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, code, auditstatus, source, status, type, vehicleid, 
    vehicleno, vehiclerfid, driverid, drivername, driveridentityno, billid, billcode, 
    billdetailid, poundnoteid, poundnotecode, abnormalperson, abnormalpersonname, abnormaltime, arrivalamount, signamount, unit, makerid, 
    makebillname, makebilltime, icardid, state, creator, createtime, modifier, modifytime, remark
  </sql>
  <sql id="P_Base_Column_List" >
    p1.id, p1.code, p1.auditstatus, p1.source, p1.status, p1.type, p1.vehicleid, 
    p1.vehicleno, p1.vehiclerfid, p1.driverid, p1.drivername, p1.driveridentityno, p1.billid, p1.billcode, 
    p1.billdetailid, p1.poundnoteid, p1.poundnotecode, p1.abnormalperson, p1.abnormalpersonname, p1.abnormaltime, p1.arrivalamount, p1.signamount, p1.unit, p1.makerid, 
    p1.makebillname, p1.makebilltime, p1.icardid, p1.state, p1.creator, p1.createtime, p1.modifier, p1.modifytime, p1.remark
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_purchase_db_arrive
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete from tr_purchase_db_arrive
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive" >
    insert into tr_purchase_db_arrive (id, code, auditstatus, 
      source, status, type, vehicleid, vehicleno, 
      vehiclerfid, driverid, drivername, 
      driveridentityno, billid, billcode, 
      billdetailid, poundnoteid, poundnotecode,
      abnormalperson, abnormalpersonname, abnormaltime, 
      arrivalamount, signamount, unit, makerid, 
      makebillname, makebilltime, icardid, state, creator, 
      createtime, modifier, modifytime, 
      remark)
    values (#{id,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, #{auditstatus,jdbcType=VARCHAR}, 
      #{source,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, #{type,jdbcType=VARCHAR}, 
      #{vehicleid,jdbcType=VARCHAR}, #{vehicleno,jdbcType=VARCHAR}, 
      #{vehiclerfid,jdbcType=VARCHAR}, #{driverid,jdbcType=VARCHAR}, #{drivername,jdbcType=VARCHAR}, 
      #{driveridentityno,jdbcType=VARCHAR}, #{billid,jdbcType=VARCHAR}, #{billcode,jdbcType=VARCHAR},
      #{billdetailid,jdbcType=VARCHAR}, #{poundnoteid,jdbcType=VARCHAR}, #{poundnotecode,jdbcType=VARCHAR}, 
      #{abnormalperson,jdbcType=VARCHAR}, #{abnormalpersonname,jdbcType=VARCHAR}, #{abnormaltime,jdbcType=BIGINT}, 
      #{arrivalamount,jdbcType=DOUBLE}, #{signamount,jdbcType=DOUBLE}, #{unit,jdbcType=VARCHAR}, #{makerid,jdbcType=VARCHAR}, #{makebillname,jdbcType=VARCHAR}, 
      #{makebilltime,jdbcType=BIGINT}, #{icardid,jdbcType=VARCHAR}, #{state,jdbcType=VARCHAR}, #{creator,jdbcType=VARCHAR}, 
      #{createtime,jdbcType=BIGINT}, #{modifier,jdbcType=VARCHAR}, #{modifytime,jdbcType=BIGINT}, 
      #{remark,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive" >
    insert into tr_purchase_db_arrive
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="auditstatus != null" >
        auditstatus,
      </if>
      <if test="source != null" >
        source,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="vehicleid != null" >
        vehicleid,
      </if>
      <if test="vehicleno != null" >
        vehicleno,
      </if>
      <if test="vehiclerfid != null" >
        vehiclerfid,
      </if>
      <if test="driverid != null" >
        driverid,
      </if>
      <if test="drivername != null" >
        drivername,
      </if>
      <if test="driveridentityno != null" >
        driveridentityno,
      </if>
      <if test="billid != null" >
        billid,
      </if>
      <if test="billcode != null" >
        billcode,
      </if>
      <if test="billdetailid != null" >
        billdetailid,
      </if>
      <if test="poundnoteid != null" >
        poundnoteid,
      </if>
      <if test="poundnotecode != null" >
        poundnotecode,
      </if>
      <if test="abnormalperson != null" >
        abnormalperson,
      </if>
      <if test="abnormalpersonname != null" >
        abnormalpersonname,
      </if>
      <if test="abnormaltime != null" >
        abnormaltime,
      </if>
      <if test="arrivalamount != null" >
        arrivalamount,
      </if>
      <if test="signamount != null" >
        signamount,
      </if>
      <if test="unit != null" >
        unit,
      </if>
      <if test="makerid != null" >
        makerid,
      </if>
      <if test="makebillname != null" >
        makebillname,
      </if>
      <if test="makebilltime != null" >
        makebilltime,
      </if>
      <if test="icardid != null" >
        icardid,
      </if>
      <if test="state != null" >
        state,
      </if>
      <if test="creator != null" >
        creator,
      </if>
      <if test="createtime != null" >
        createtime,
      </if>
      <if test="modifier != null" >
        modifier,
      </if>
      <if test="modifytime != null" >
        modifytime,
      </if>
      <if test="remark != null" >
        remark,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="auditstatus != null" >
        #{auditstatus,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        #{source,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="vehicleid != null" >
        #{vehicleid,jdbcType=VARCHAR},
      </if>
      <if test="vehicleno != null" >
        #{vehicleno,jdbcType=VARCHAR},
      </if>
      <if test="vehiclerfid != null" >
        #{vehiclerfid,jdbcType=VARCHAR},
      </if>
      <if test="driverid != null" >
        #{driverid,jdbcType=VARCHAR},
      </if>
      <if test="drivername != null" >
        #{drivername,jdbcType=VARCHAR},
      </if>
      <if test="driveridentityno != null" >
        #{driveridentityno,jdbcType=VARCHAR},
      </if>
      <if test="billid != null" >
        #{billid,jdbcType=VARCHAR},
      </if>
      <if test="billcode != null" >
        #{billcode,jdbcType=VARCHAR},
      </if>
      <if test="billdetailid != null" >
        #{billdetailid,jdbcType=VARCHAR},
      </if>
      <if test="poundnoteid != null" >
        #{poundnoteid,jdbcType=VARCHAR},
      </if>
      <if test="poundnotecode != null" >
        #{poundnotecode,jdbcType=VARCHAR},
      </if>
      <if test="abnormalperson != null" >
        #{abnormalperson,jdbcType=VARCHAR},
      </if>
      <if test="abnormalpersonname != null" >
        #{abnormalpersonname,jdbcType=VARCHAR},
      </if>
      <if test="abnormaltime != null" >
        #{abnormaltime,jdbcType=BIGINT},
      </if>
      <if test="arrivalamount != null" >
        #{arrivalamount,jdbcType=DOUBLE},
      </if>
      <if test="signamount != null" >
        #{signamount,jdbcType=DOUBLE},
      </if>
      <if test="unit != null" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="makerid != null" >
        #{makerid,jdbcType=VARCHAR},
      </if>
      <if test="makebillname != null" >
        #{makebillname,jdbcType=VARCHAR},
      </if>
      <if test="makebilltime != null" >
        #{makebilltime,jdbcType=BIGINT},
      </if>
      <if test="icardid != null" >
        #{icardid,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=BIGINT},
      </if>
      <if test="modifier != null" >
        #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="modifytime != null" >
        #{modifytime,jdbcType=BIGINT},
      </if>
      <if test="remark != null" >
        #{remark,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive" >
    update tr_purchase_db_arrive
    <set >
      <if test="code != null" >
        code = #{code,jdbcType=VARCHAR},
      </if>
      <if test="auditstatus != null" >
        auditstatus = #{auditstatus,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        source = #{source,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        type = #{type,jdbcType=VARCHAR},
      </if>
      <if test="vehicleid != null" >
        vehicleid = #{vehicleid,jdbcType=VARCHAR},
      </if>
      <if test="vehicleno != null" >
        vehicleno = #{vehicleno,jdbcType=VARCHAR},
      </if>
      <if test="vehiclerfid != null" >
        vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR},
      </if>
      <if test="driverid != null" >
        driverid = #{driverid,jdbcType=VARCHAR},
      </if>
      <if test="drivername != null" >
        drivername = #{drivername,jdbcType=VARCHAR},
      </if>
      <if test="driveridentityno != null" >
        driveridentityno = #{driveridentityno,jdbcType=VARCHAR},
      </if>
      <if test="billid != null" >
        billid = #{billid,jdbcType=VARCHAR},
      </if>
      <if test="billcode != null" >
        billcode = #{billcode,jdbcType=VARCHAR},
      </if>
      <if test="billdetailid != null" >
        billdetailid = #{billdetailid,jdbcType=VARCHAR},
      </if>
      <if test="poundnoteid != null" >
        poundnoteid = #{poundnoteid,jdbcType=VARCHAR},
      </if>
      <if test="poundnotecode != null" >
        poundnotecode = #{poundnotecode,jdbcType=VARCHAR},
      </if>
      <if test="abnormalperson != null" >
        abnormalperson = #{abnormalperson,jdbcType=VARCHAR},
      </if>
      <if test="abnormalpersonname != null" >
        abnormalpersonname = #{abnormalpersonname,jdbcType=VARCHAR},
      </if>
      <if test="abnormaltime != null" >
        abnormaltime = #{abnormaltime,jdbcType=BIGINT},
      </if>
      <if test="arrivalamount != null" >
        arrivalamount = #{arrivalamount,jdbcType=DOUBLE},
      </if>
      <if test="signamount != null" >
        signamount = #{signamount,jdbcType=DOUBLE},
      </if>
      <if test="unit != null" >
        unit = #{unit,jdbcType=VARCHAR},
      </if>
      <if test="makerid != null" >
        makerid = #{makerid,jdbcType=VARCHAR},
      </if>
      <if test="makebillname != null" >
        makebillname = #{makebillname,jdbcType=VARCHAR},
      </if>
      <if test="makebilltime != null" >
        makebilltime = #{makebilltime,jdbcType=BIGINT},
      </if>
      <if test="icardid != null" >
        icardid = #{icardid,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        creator = #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        createtime = #{createtime,jdbcType=BIGINT},
      </if>
      <if test="modifier != null" >
        modifier = #{modifier,jdbcType=VARCHAR},
      </if>
      <if test="modifytime != null" >
        modifytime = #{modifytime,jdbcType=BIGINT},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive" >
    update tr_purchase_db_arrive
    set code = #{code,jdbcType=VARCHAR},
      auditstatus = #{auditstatus,jdbcType=VARCHAR},
      source = #{source,jdbcType=VARCHAR},
      status = #{status,jdbcType=VARCHAR},
      type = #{type,jdbcType=VARCHAR},
      vehicleid = #{vehicleid,jdbcType=VARCHAR},
      vehicleno = #{vehicleno,jdbcType=VARCHAR},
      vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR},
      driverid = #{driverid,jdbcType=VARCHAR},
      drivername = #{drivername,jdbcType=VARCHAR},
      driveridentityno = #{driveridentityno,jdbcType=VARCHAR},
      billid = #{billid,jdbcType=VARCHAR},
      billcode = #{billcode,jdbcType=VARCHAR},
      billdetailid = #{billdetailid,jdbcType=VARCHAR},
      poundnoteid = #{poundnoteid,jdbcType=VARCHAR},
      poundnotecode = #{poundnotecode,jdbcType=VARCHAR},
      abnormalperson = #{abnormalperson,jdbcType=VARCHAR},
      abnormalpersonname = #{abnormalpersonname,jdbcType=VARCHAR},
      abnormaltime = #{abnormaltime,jdbcType=BIGINT},
      arrivalamount = #{arrivalamount,jdbcType=DOUBLE},
      signamount = #{signamount,jdbcType=DOUBLE},
      unit = #{unit,jdbcType=VARCHAR},
      makerid = #{makerid,jdbcType=VARCHAR},
      makebillname = #{makebillname,jdbcType=VARCHAR},
      makebilltime = #{makebilltime,jdbcType=BIGINT},
      icardid = #{icardid,jdbcType=VARCHAR},
      state = #{state,jdbcType=VARCHAR},
      creator = #{creator,jdbcType=VARCHAR},
      createtime = #{createtime,jdbcType=BIGINT},
      modifier = #{modifier,jdbcType=VARCHAR},
      modifytime = #{modifytime,jdbcType=BIGINT},
      remark = #{remark,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <select id="selectSelective" parameterType="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_purchase_db_arrive
	<where>
	  <if test="id != null and id != ''" >
        and id = #{id,jdbcType=VARCHAR}
      </if>
	  <if test="code != null and code != ''" >
        and code = #{code,jdbcType=VARCHAR}
      </if>
      <if test="auditstatus != null and auditstatus != ''" >
        and auditstatus = #{auditstatus,jdbcType=VARCHAR}
      </if>
      <if test="source != null and source != ''" >
        and source = #{source,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != ''" >
        and status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="type != null and type != ''" >
        and type = #{type,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != ''" >
        and vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="vehicleno != null and vehicleno != ''" >
        and vehicleno = #{vehicleno,jdbcType=VARCHAR}
      </if>
      <if test="vehiclerfid != null and vehiclerfid != ''" >
        and vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR}
      </if>
      <if test="driverid != null and driverid != ''" >
        and driverid = #{driverid,jdbcType=VARCHAR}
      </if>
      <if test="drivername != null and drivername != ''" >
        and drivername = #{drivername,jdbcType=VARCHAR}
      </if>
      <if test="driveridentityno != null and driveridentityno != ''" >
        and driveridentityno = #{driveridentityno,jdbcType=VARCHAR}
      </if>
      <if test="billid != null and billid != ''" >
        and billid = #{billid,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != ''" >
        and billcode = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="billdetailid != null and billdetailid != ''" >
        and billdetailid = #{billdetailid,jdbcType=VARCHAR}
      </if>
      <if test="poundnoteid != null and poundnoteid != ''" >
        and poundnoteid = #{poundnoteid,jdbcType=VARCHAR}
      </if>
      <if test="poundnotecode != null and poundnotecode != ''" >
        and poundnotecode = #{poundnotecode,jdbcType=VARCHAR}
      </if>
      <if test="abnormalperson != null and abnormalperson != ''" >
        and abnormalperson = #{abnormalperson,jdbcType=VARCHAR}
      </if>
      <if test="abnormalpersonname != null and abnormalpersonname != ''" >
        and abnormalpersonname = #{abnormalpersonname,jdbcType=VARCHAR}
      </if>
      <if test="abnormaltime != null and abnormaltime != ''" >
        and abnormaltime = #{abnormaltime,jdbcType=BIGINT}
      </if>
      <if test="arrivalamount != null and arrivalamount != ''" >
        and arrivalamount = #{arrivalamount,jdbcType=DOUBLE}
      </if>
      <if test="signamount != null and signamount != ''" >
        and signamount = #{signamount,jdbcType=DOUBLE}
      </if>
      <if test="unit != null and unit != ''" >
        and unit = #{unit,jdbcType=VARCHAR}
      </if>
      <if test="makerid != null and makerid != ''" >
        and makerid = #{makerid,jdbcType=VARCHAR}
      </if>
      <if test="makebillname != null and makebillname != ''" >
        and makebillname = #{makebillname,jdbcType=VARCHAR}
      </if>
      <if test="makebilltime != null and makebilltime != ''" >
        and makebilltime = #{makebilltime,jdbcType=BIGINT}
      </if>
      <if test="icardid != null and state != ''" >
        and icardid = #{icardid,jdbcType=VARCHAR}
      </if>
      <if test="state != null and state != ''" >
        and state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="creator != null and creator != ''" >
        and creator = #{creator,jdbcType=VARCHAR}
      </if>
      <if test="createtime != null and createtime != ''" >
        and createtime = #{createtime,jdbcType=BIGINT}
      </if>
      <if test="modifier != null and modifier != ''" >
        and modifier = #{modifier,jdbcType=VARCHAR}
      </if>
      <if test="modifytime != null and modifytime != ''" >
        and modifytime = #{modifytime,jdbcType=BIGINT}
      </if>
      <if test="remark != null and remark != ''" >
        and remark = #{remark,jdbcType=VARCHAR}
      </if>
	</where>	
  </select>
  <select id="findPurchaseArrivePage" parameterType="com.tianrui.api.req.businessManage.purchaseManage.PurchaseArriveQuery" resultMap="BaseResultMap">
  	select
  	<include refid="P_Base_Column_List" />
  	from tr_purchase_db_arrive p1
  	left join tr_purchase_db_application p2 on p1.billid = p2.id
  	left join tr_purchase_db_application_detail p3 on p1.billdetailid = p3.id
  	<where>
  	  <if test="code != null and code !=''" >
        and p1.code = #{code,jdbcType=VARCHAR}
      </if>
  	  <if test="auditstatus != null and auditstatus !=''" >
        and p1.auditstatus = #{auditstatus,jdbcType=VARCHAR}
      </if>
  	  <if test="source != null and source !=''" >
        and p1.source = #{source,jdbcType=VARCHAR}
      </if>
  	  <if test="status != null and status !=''" >
        and p1.status = #{status,jdbcType=VARCHAR}
      </if>
  	  <if test="type != null and type !=''" >
        and p1.type = #{type,jdbcType=VARCHAR}
      </if>
  	  <if test="supplierid != null and supplierid !=''" >
        and p2.supplierid = #{supplierid,jdbcType=VARCHAR}
      </if>
  	  <if test="vehicleid != null and vehicleid !=''" >
        and p1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
  	  <if test="driverid != null and driverid !=''" >
        and p1.driverid = #{driverid,jdbcType=VARCHAR}
      </if>
  	  <if test="materielid != null and materielid !=''" >
        and p3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
  	  <if test="billcode != null and billcode !=''" >
        and p1.billcode = #{billcode,jdbcType=VARCHAR}
      </if>
  	  <if test="state != null and state !=''" >
        and p1.state = #{state,jdbcType=VARCHAR}
      </if>
	  <if test="starttime != null and starttime != ''">
		and p1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and p1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  	order by p1.makebilltime
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="findPurchaseArrivePageCount" parameterType="com.tianrui.api.req.businessManage.purchaseManage.PurchaseArriveQuery" resultType="java.lang.Long">
  	select count(0)
  	from tr_purchase_db_arrive p1
  	left join tr_purchase_db_application p2 on p1.billid = p2.id
  	left join tr_purchase_db_application_detail p3 on p1.billdetailid = p3.id
  	<where>
  	  <if test="code != null and code !=''" >
        and p1.code = #{code,jdbcType=VARCHAR}
      </if>
  	  <if test="auditstatus != null and auditstatus !=''" >
        and p1.auditstatus = #{auditstatus,jdbcType=VARCHAR}
      </if>
  	  <if test="source != null and source !=''" >
        and p1.source = #{source,jdbcType=VARCHAR}
      </if>
  	  <if test="status != null and status !=''" >
        and p1.status = #{status,jdbcType=VARCHAR}
      </if>
  	  <if test="type != null and type !=''" >
        and p1.type = #{type,jdbcType=VARCHAR}
      </if>
  	  <if test="supplierid != null and supplierid !=''" >
        and p2.supplierid = #{supplierid,jdbcType=VARCHAR}
      </if>
  	  <if test="vehicleid != null and vehicleid !=''" >
        and p1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
  	  <if test="driverid != null and driverid !=''" >
        and p1.driverid = #{driverid,jdbcType=VARCHAR}
      </if>
  	  <if test="materielid != null and materielid !=''" >
        and p3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
  	  <if test="billcode != null and billcode !=''" >
        and p1.billcode = #{billcode,jdbcType=VARCHAR}
      </if>
  	  <if test="state != null and state !=''" >
        and p1.state = #{state,jdbcType=VARCHAR}
      </if>
	  <if test="starttime != null and starttime != ''">
		and p1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and p1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  </select>
  <select id="checkDriverAndVehicleIsUse" resultMap="BaseResultMap" parameterType="com.tianrui.service.bean.businessManage.purchaseManage.PurchaseArrive">
  	select 
	<include refid="Base_Column_List" />
  	from tr_purchase_db_arrive
  	<where>
  		status != '5' and status != '3' and state = '1'
  		<if test="id != null and id != ''">
  			and id != #{id,jdbcType=VARCHAR}
  		</if>
  		<if test="driverid != null and driverid != ''">
  			and driverid = #{driverid,jdbcType=VARCHAR}
  		</if>
  		<if test="vehicleid != null and vehicleid != ''">
  			and vehicleid = #{vehicleid,jdbcType=VARCHAR}
  		</if>
  	</where>
  </select>
  <select id="selectByIds" parameterType="java.util.List" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_purchase_db_arrive
  	where id in
	<foreach item="item" index="index" collection="list" open="(" separator="," close=")">  
		#{item}  
	</foreach>
  </select>
  <select id="hasPurchaseArrive" parameterType="java.lang.String" resultMap="BaseResultMap">
  	select
  	<include refid="Base_Column_List" />
  	from tr_purchase_db_arrive
  	where vehicleno = #{vehicleno,jdbcType=VARCHAR} and state = '1' and status!='3' and status!='5'
  </select>
    <select id="selectByCode" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_purchase_db_arrive
    where code = #{code,jdbcType=VARCHAR}
  </select>
   <select id="checkICUse" resultMap="BaseResultMap" parameterType="java.lang.String">
  	select 
	<include refid="Base_Column_List" />
  	from tr_purchase_db_arrive
  	where icardid = #{icardid,jdbcType=VARCHAR} and state = "1" and status != '5' and status != '3'
  </select>
  <select id="validNoticeByVehicle" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from tr_purchase_db_arrive
    where vehicleno = #{vehicleno,jdbcType=VARCHAR} and vehiclerfid = #{vehiclerfid,jdbcType=VARCHAR} 
    	and status != '3' and status != '5' and state = '1'
  </select>
  <select id="findAppNoticePage" parameterType="com.tianrui.api.req.businessManage.app.AppNoticeOrderReq" resultType="com.tianrui.api.resp.businessManage.app.AppNoticeOrderResp">
  	select
  	p1.id, p1.code, p1.billcode as billCode, p2.billtime as billtime, p1.makebilltime as noticetime,
  	p1.vehicleno, p3.materielname as materialName, b1.arrivalamount as number, b1.source, b1. status
  	from tr_purchase_db_arrive p1
  	left join tr_purchase_db_application p2 on p1.billid = p2.id
  	left join tr_purchase_db_application_detail p3 on p1.billdetailid = p3.id
  	<where>
      <if test="code != null and code != '' ">
        and p1.code = #{code,jdbcType=VARCHAR}
      </if>
  	  <if test="state != null and state !=''" >
        and p1.state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != '' ">
        and p1.status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != '' ">
        and p2.code = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != '' ">
        and p1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="materielid != null and materielid != '' ">
        and p3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
      <if test="userId != null and userId != '' ">
        and p1.makerid = #{userId,jdbcType=VARCHAR}
      </if>
      <if test="starttime != null and starttime != ''">
		and p1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and p1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  	<if test="orderColumn != null and orderColumn != ''">
  		order by #{orderColumn,jdbcType=VARCHAR} 
  		<choose>
  			<when test="orderAsc == 'DESC'">
  				DESC
  			</when>
  			<otherwise>
  				ASC
  			</otherwise>
  		</choose>
  	</if>
  	<if test="start != null and start >= 0">
  		<if test="limit != null">
			limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
  		</if>
  	</if>
  </select>
  <select id="findAppNoticePageCount" parameterType="com.tianrui.api.req.businessManage.app.AppNoticeOrderReq" resultType="java.lang.Long">
  	select count(0)
  	from tr_purchase_db_arrive p1
  	left join tr_purchase_db_application p2 on p1.billid = p2.id
  	left join tr_purchase_db_application_detail p3 on p1.billdetailid = p3.id
  	<where>
      <if test="code != null and code != '' ">
        and p1.code = #{code,jdbcType=VARCHAR}
      </if>
  	  <if test="state != null and state !=''" >
        and p1.state = #{state,jdbcType=VARCHAR}
      </if>
      <if test="status != null and status != '' ">
        and p1.status = #{status,jdbcType=VARCHAR}
      </if>
      <if test="billcode != null and billcode != '' ">
        and p2.code = #{billcode,jdbcType=VARCHAR}
      </if>
      <if test="vehicleid != null and vehicleid != '' ">
        and p1.vehicleid = #{vehicleid,jdbcType=VARCHAR}
      </if>
      <if test="materielid != null and materielid != '' ">
        and p3.materielid = #{materielid,jdbcType=VARCHAR}
      </if>
      <if test="userId != null and userId != '' ">
        and p1.makerid = #{userId,jdbcType=VARCHAR}
      </if>
      <if test="starttime != null and starttime != ''">
		and p1.makebilltime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT}
	  </if>
	  <if test="endtime != null and endtime != ''">
		and p1.makebilltime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	  </if>
  	</where>
  </select>
</mapper>